; Listing generated by Microsoft (R) Optimizing Compiler Version 16.00.40219.01 

include listing.inc

INCLUDELIB OLDNAMES

;	COMDAT ?c@?1??lzo1x_999_compress_level@@9@4QBU<unnamed-type-c>@?1??1@9@B
CONST	SEGMENT
?c@?1??lzo1x_999_compress_level@@9@4QBU<unnamed-type-c>@?1??1@9@B DD 00H ; `lzo1x_999_compress_level'::`2'::c
	ORG $+4
	DQ	0000000000000000H
	DQ	0000000000000000H
	DQ	0000000000000008H
	DQ	0000000000000004H
	DD	00H
	ORG $+4
	DD	00H
	ORG $+4
	DQ	0000000000000000H
	DQ	0000000000000000H
	DQ	0000000000000010H
	DQ	0000000000000008H
	DD	00H
	ORG $+4
	DD	00H
	ORG $+4
	DQ	0000000000000000H
	DQ	0000000000000000H
	DQ	0000000000000020H
	DQ	0000000000000010H
	DD	00H
	ORG $+4
	DD	01H
	ORG $+4
	DQ	0000000000000004H
	DQ	0000000000000004H
	DQ	0000000000000010H
	DQ	0000000000000010H
	DD	00H
	ORG $+4
	DD	01H
	ORG $+4
	DQ	0000000000000008H
	DQ	0000000000000010H
	DQ	0000000000000020H
	DQ	0000000000000020H
	DD	00H
	ORG $+4
	DD	01H
	ORG $+4
	DQ	0000000000000008H
	DQ	0000000000000010H
	DQ	0000000000000080H
	DQ	0000000000000080H
	DD	00H
	ORG $+4
	DD	02H
	ORG $+4
	DQ	0000000000000008H
	DQ	0000000000000020H
	DQ	0000000000000080H
	DQ	0000000000000100H
	DD	00H
	ORG $+4
	DD	02H
	ORG $+4
	DQ	0000000000000020H
	DQ	0000000000000080H
	DQ	0000000000000800H
	DQ	0000000000000800H
	DD	01H
	ORG $+4
	DD	02H
	ORG $+4
	DQ	0000000000000800H
	DQ	0000000000000800H
	DQ	0000000000000800H
	DQ	0000000000001000H
	DD	01H
	ORG $+4
; Function compile flags: /Ogtpy
; File c:\users\nummer\documents\github\olr-3.0\src\xray\xrcore\rt_lzo1x_9x.cpp
_TEXT	SEGMENT
swd$ = 8
m_len$ = 16
m_off$ = 24
?better_match@@YAXPEBUlzo1x_999_swd_t@@PEA_K1@Z PROC	; better_match

; 465  : #if defined(LZO1Z)
; 466  :     const LZO_COMPRESS_T *c = swd->c;
; 467  : #endif
; 468  : 
; 469  :     if (*m_len <= M2_MIN_LEN)

	mov	rax, QWORD PTR [rdx]
	mov	r9, rcx
	cmp	rax, 3
	jbe	$LN1@better_mat

; 470  :         return;
; 471  : #if defined(LZO1Z)
; 472  :     if (*m_off == c->last_m_off && *m_len <= M2_MAX_LEN)
; 473  :         return;
; 474  : #if 1
; 475  :     if (*m_len >= M2_MIN_LEN + 1 && *m_len <= M2_MAX_LEN + 1 &&
; 476  :         c->last_m_off && swd->best_off[*m_len-1] == c->last_m_off)
; 477  :     {
; 478  :         *m_len = *m_len - 1;
; 479  :         *m_off = swd->best_off[*m_len];
; 480  :         return;
; 481  :     }
; 482  : #endif
; 483  : #endif
; 484  : 
; 485  :     if (*m_off <= M2_MAX_OFFSET)

	mov	r10, QWORD PTR [r8]
	cmp	r10, 2048				; 00000800H
	jbe	$LN1@better_mat

; 486  :         return;
; 487  : 
; 488  : #if 1
; 489  :     /* M3/M4 -> M2 */
; 490  :     if (*m_off > M2_MAX_OFFSET &&
; 491  :         *m_len >= M2_MIN_LEN + 1 && *m_len <= M2_MAX_LEN + 1 &&
; 492  :         swd->best_off[*m_len-1] && swd->best_off[*m_len-1] <= M2_MAX_OFFSET)

	cmp	rax, 4
	jb	SHORT $LN3@better_mat
	cmp	rax, 9
	ja	SHORT $LN3@better_mat
	mov	rcx, QWORD PTR [rcx+rax*8+80]
	test	rcx, rcx
	je	SHORT $LN3@better_mat
	cmp	rcx, 2048				; 00000800H

; 493  :     {
; 494  :         *m_len = *m_len - 1;
; 495  :         *m_off = swd->best_off[*m_len];
; 496  :         return;

	jbe	SHORT $LN9@better_mat
$LN3@better_mat:

; 497  :     }
; 498  : #endif
; 499  : 
; 500  : #if 1
; 501  :     /* M4 -> M2 */
; 502  :     if (*m_off > M3_MAX_OFFSET &&
; 503  :         *m_len >= M4_MAX_LEN + 1 && *m_len <= M2_MAX_LEN + 2 &&
; 504  :         swd->best_off[*m_len-2] && swd->best_off[*m_len-2] <= M2_MAX_OFFSET)

	cmp	r10, 16384				; 00004000H
	jbe	SHORT $LN1@better_mat
	cmp	rax, 10
	jb	SHORT $LN1@better_mat
	ja	SHORT $LN11@better_mat
	mov	rcx, QWORD PTR [r9+rax*8+72]
	test	rcx, rcx
	je	SHORT $LN2@better_mat
	cmp	rcx, 2048				; 00000800H
	ja	SHORT $LN2@better_mat

; 505  :     {
; 506  :         *m_len = *m_len - 2;

	add	rax, -2

; 517  :     {
; 518  :         *m_len = *m_len - 1;

	mov	QWORD PTR [rdx], rax

; 519  :         *m_off = swd->best_off[*m_len];

	mov	rax, QWORD PTR [r9+rax*8+88]
	mov	QWORD PTR [r8], rax

; 520  :     }
; 521  : #endif
; 522  : }

	ret	0
$LN2@better_mat:

; 507  :         *m_off = swd->best_off[*m_len];
; 508  :         return;
; 509  :     }
; 510  : #endif
; 511  : 
; 512  : #if 1
; 513  :     /* M4 -> M3 */
; 514  :     if (*m_off > M3_MAX_OFFSET &&
; 515  :         *m_len >= M4_MAX_LEN + 1 && *m_len <= M3_MAX_LEN + 1 &&
; 516  :         swd->best_off[*m_len-1] && swd->best_off[*m_len-1] <= M3_MAX_OFFSET)

	cmp	rax, 10
	jb	SHORT $LN1@better_mat
$LN11@better_mat:
	cmp	rax, 34					; 00000022H
	ja	SHORT $LN1@better_mat
	mov	rcx, QWORD PTR [r9+rax*8+80]
	test	rcx, rcx
	je	SHORT $LN1@better_mat
	cmp	rcx, 16384				; 00004000H
	ja	SHORT $LN1@better_mat
$LN9@better_mat:

; 517  :     {
; 518  :         *m_len = *m_len - 1;

	dec	rax
	mov	QWORD PTR [rdx], rax

; 519  :         *m_off = swd->best_off[*m_len];

	mov	rax, QWORD PTR [r9+rax*8+88]
	mov	QWORD PTR [r8], rax
$LN1@better_mat:

; 520  :     }
; 521  : #endif
; 522  : }

	fatret	0
?better_match@@YAXPEBUlzo1x_999_swd_t@@PEA_K1@Z ENDP	; better_match
_TEXT	ENDS
pdata	SEGMENT
$pdata$?min_gain@@YA_J_K00HHH@Z DD imagerel ?min_gain@@YA_J_K00HHH@Z
	DD	imagerel ?min_gain@@YA_J_K00HHH@Z+104
	DD	imagerel $unwind$?min_gain@@YA_J_K00HHH@Z
pdata	ENDS
xdata	SEGMENT
$unwind$?min_gain@@YA_J_K00HHH@Z DD 020501H
	DD	013405H
; Function compile flags: /Ogtpy
xdata	ENDS
_TEXT	SEGMENT
ahead$ = 8
lit1$ = 16
lit2$ = 24
l1$ = 32
l2$ = 40
l3$ = 48
?min_gain@@YA_J_K00HHH@Z PROC				; min_gain

; 388  : {

	mov	QWORD PTR [rsp+8], rbx

; 389  :     lzo_int lazy_match_min_gain = 0;
; 390  : 
; 391  :     assert (ahead >= 1);
; 392  :     lazy_match_min_gain += ahead;
; 393  : 
; 394  : #if 0
; 395  :     if (l3 > 0)
; 396  :         lit2 -= ahead;
; 397  : #endif
; 398  : 
; 399  :     if (lit1 <= 3)

	xor	ebx, ebx
	mov	r11, rcx
	mov	r10, rcx
	cmp	rdx, 3
	ja	SHORT $LN5@min_gain

; 400  :         lazy_match_min_gain += (lit2 <= 3) ? 0 : 2;

	mov	r10d, 2
	cmp	r8, 3
	cmovbe	r10d, ebx
	jmp	SHORT $LN8@min_gain
$LN5@min_gain:

; 401  :     else if (lit1 <= 18)

	cmp	rdx, 18
	ja	SHORT $LN3@min_gain

; 402  :         lazy_match_min_gain += (lit2 <= 18) ? 0 : 1;

	cmp	r8, 18
	mov	r10, rbx
	seta	r10b
$LN8@min_gain:
	add	r10, rcx
$LN3@min_gain:

; 403  : 
; 404  :     lazy_match_min_gain += (l2 - l1) * 2;

	mov	eax, DWORD PTR l2$[rsp]
	sub	eax, r9d
	add	eax, eax
	cdqe
	add	r10, rax

; 405  :     if (l3 > 0)

	movsxd	rax, DWORD PTR l3$[rsp]
	test	eax, eax
	jle	SHORT $LN2@min_gain

; 406  :         lazy_match_min_gain -= (ahead - l3) * 2;

	mov	rcx, rax
	sub	rcx, r11
	lea	r10, QWORD PTR [r10+rcx*2]
$LN2@min_gain:

; 407  : 
; 408  :     if (lazy_match_min_gain < 0)

	test	r10, r10
	cmovs	r10, rbx

; 409  :         lazy_match_min_gain = 0;
; 410  : 
; 411  : #if 0
; 412  :     if (l1 == 2)
; 413  :         if (lazy_match_min_gain == 0)
; 414  :             lazy_match_min_gain = 1;
; 415  : #endif
; 416  : 
; 417  :     return lazy_match_min_gain;
; 418  : }

	mov	rbx, QWORD PTR [rsp+8]
	mov	rax, r10
	ret	0
?min_gain@@YA_J_K00HHH@Z ENDP				; min_gain
; Function compile flags: /Ogtpy
m_len$ = 8
m_off$ = 16
lit$ = 24
?len_of_coded_match@@YAH_K00@Z PROC			; len_of_coded_match

; 348  :     int n = 4;

	mov	eax, 4

; 349  : 
; 350  :     if (m_len < 2)

	cmp	rcx, 2

; 351  :         return -1;

	jb	$LN4@len_of_cod

; 352  :     if (m_len == 2)

	jne	SHORT $LN11@len_of_cod

; 353  :         return (m_off <= M1_MAX_OFFSET && lit > 0 && lit < 4) ? 2 : -1;

	cmp	rdx, 1024				; 00000400H
	ja	$LN4@len_of_cod
	lea	rax, QWORD PTR [r8-1]
	cmp	rax, 2
	ja	$LN4@len_of_cod
$LN22@len_of_cod:
	mov	eax, 2

; 383  : }

	ret	0
$LN11@len_of_cod:

; 354  :     if (m_len <= M2_MAX_LEN && m_off <= M2_MAX_OFFSET)

	cmp	rcx, 8
	ja	SHORT $LN10@len_of_cod
	cmp	rdx, 2048				; 00000800H

; 355  :         return 2;

	jbe	SHORT $LN22@len_of_cod
$LN10@len_of_cod:

; 356  :     if (m_len == M2_MIN_LEN && m_off <= MX_MAX_OFFSET && lit >= 4)

	cmp	rcx, 3
	jne	SHORT $LN9@len_of_cod
	cmp	rdx, 3072				; 00000c00H
	ja	SHORT $LN9@len_of_cod
	cmp	r8, rax

; 357  :         return 2;

	jae	SHORT $LN22@len_of_cod
$LN9@len_of_cod:

; 358  :     if (m_off <= M3_MAX_OFFSET)

	cmp	rdx, 16384				; 00004000H
	ja	SHORT $LN8@len_of_cod

; 359  :     {
; 360  :         if (m_len <= M3_MAX_LEN)

	cmp	rcx, 33					; 00000021H
	ja	SHORT $LN7@len_of_cod
$LN23@len_of_cod:

; 361  :             return 3;

	mov	eax, 3

; 383  : }

	ret	0
$LN7@len_of_cod:

; 362  :         m_len -= M3_MAX_LEN;

	sub	rcx, 33					; 00000021H

; 363  :         while (m_len > 255)

	cmp	rcx, 255				; 000000ffH
	jbe	SHORT $LN13@len_of_cod

; 362  :         m_len -= M3_MAX_LEN;

	add	rcx, -256				; ffffffffffffff00H
	mov	rax, -9187201950435737471		; 8080808080808081H
	mul	rcx
	mov	rax, rdx
	shr	rax, 7

; 363  :         while (m_len > 255)

	add	eax, 5

; 383  : }

	ret	0
$LN8@len_of_cod:

; 364  :         {
; 365  :             m_len -= 255;
; 366  :             n++;
; 367  :         }
; 368  :         return n;
; 369  :     }
; 370  :     if (m_off <= M4_MAX_OFFSET)

	cmp	rdx, 49151				; 0000bfffH
	ja	SHORT $LN4@len_of_cod

; 371  :     {
; 372  :         if (m_len <= M4_MAX_LEN)

	cmp	rcx, 9

; 373  :             return 3;

	jbe	SHORT $LN23@len_of_cod

; 374  :         m_len -= M4_MAX_LEN;

	sub	rcx, 9

; 375  :         while (m_len > 255)

	cmp	rcx, 255				; 000000ffH
	jbe	SHORT $LN13@len_of_cod

; 374  :         m_len -= M4_MAX_LEN;

	add	rcx, -256				; ffffffffffffff00H
	mov	rax, -9187201950435737471		; 8080808080808081H
	mul	rcx
	shr	rdx, 7

; 375  :         while (m_len > 255)

	lea	eax, DWORD PTR [rdx+5]

; 383  : }

	ret	0
$LN4@len_of_cod:

; 376  :         {
; 377  :             m_len -= 255;
; 378  :             n++;
; 379  :         }
; 380  :         return n;
; 381  :     }
; 382  :     return -1;

	or	eax, -1
$LN13@len_of_cod:

; 383  : }

	fatret	0
?len_of_coded_match@@YAH_K00@Z ENDP			; len_of_coded_match
_TEXT	ENDS
EXTRN	memset:PROC
pdata	SEGMENT
$pdata$?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z DD imagerel ?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z
	DD	imagerel ?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z+13
	DD	imagerel $unwind$?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z
$pdata$0$?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z DD imagerel ?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z+13
	DD	imagerel ?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z+100
	DD	imagerel $chain$0$?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z
$pdata$1$?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z DD imagerel ?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z+100
	DD	imagerel ?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z+121
	DD	imagerel $chain$1$?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z
$pdata$2$?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z DD imagerel ?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z+121
	DD	imagerel ?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z+187
	DD	imagerel $chain$2$?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z
$pdata$3$?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z DD imagerel ?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z+187
	DD	imagerel ?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z+204
	DD	imagerel $chain$3$?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z
$pdata$4$?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z DD imagerel ?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z+204
	DD	imagerel ?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z+224
	DD	imagerel $chain$4$?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z
$pdata$5$?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z DD imagerel ?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z+224
	DD	imagerel ?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z+252
	DD	imagerel $chain$5$?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z
pdata	ENDS
xdata	SEGMENT
$unwind$?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z DD 040901H
	DD	0c0053209H
	DD	060027003H
$chain$0$?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z DD 020521H
	DD	095405H
	DD	imagerel ?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z
	DD	imagerel ?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z+13
	DD	imagerel $unwind$?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z
$chain$1$?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z DD 020521H
	DD	0ad405H
	DD	imagerel ?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z+13
	DD	imagerel ?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z+100
	DD	imagerel $chain$0$?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z
$chain$2$?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z DD 020521H
	DD	083405H
	DD	imagerel ?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z+100
	DD	imagerel ?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z+121
	DD	imagerel $chain$1$?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z
$chain$3$?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z DD 021H
	DD	imagerel ?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z+100
	DD	imagerel ?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z+121
	DD	imagerel $chain$1$?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z
$chain$4$?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z DD 021H
	DD	imagerel ?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z+13
	DD	imagerel ?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z+100
	DD	imagerel $chain$0$?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z
$chain$5$?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z DD 021H
	DD	imagerel ?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z
	DD	imagerel ?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z+13
	DD	imagerel $unwind$?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z
; Function compile flags: /Ogtpy
xdata	ENDS
_TEXT	SEGMENT
c$ = 64
op$ = 72
ii$ = 80
t$ = 88
?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z PROC	; STORE_RUN

; 278  : {

	push	rsi
	push	rdi
	push	r12
	sub	rsp, 32					; 00000020H

; 279  :     c->lit_bytes += (unsigned long) t;

	add	DWORD PTR [rcx+120], r9d
	mov	QWORD PTR [rsp+72], rbp
	mov	rsi, r9
	mov	r12, r8
	mov	rdi, rdx
	mov	rbp, rcx

; 280  : 
; 281  :     if (op == c->out && t <= 238)

	cmp	rdx, QWORD PTR [rcx+80]
	jne	SHORT $LN11@STORE_RUN
	cmp	r9, 238					; 000000eeH
	ja	SHORT $LN11@STORE_RUN

; 282  :     {
; 283  :         *op++ = LZO_BYTE(17 + t);

	lea	eax, DWORD PTR [r9+17]
	inc	rdi
	mov	BYTE PTR [rdx], al
	jmp	$LN17@STORE_RUN
$LN11@STORE_RUN:

; 284  :     }
; 285  :     else if (t <= 3)

	cmp	r9, 3
	ja	SHORT $LN9@STORE_RUN

; 286  :     {
; 287  : #if defined(LZO1Z)
; 288  :         op[-1] |= LZO_BYTE(t);
; 289  : #else
; 290  :         op[-2] |= LZO_BYTE(t);

	or	BYTE PTR [rdx-2], r9b

; 291  : #endif
; 292  :         c->lit1_r++;

	inc	DWORD PTR [rcx+172]
	jmp	SHORT $LN17@STORE_RUN
$LN9@STORE_RUN:

; 293  :     }
; 294  :     else if (t <= 18)
; 295  :     {
; 296  :         *op++ = LZO_BYTE(t - 3);

	inc	rdi
	cmp	r9, 18
	ja	SHORT $LN7@STORE_RUN
	lea	eax, DWORD PTR [r9-3]
	mov	BYTE PTR [rdx], al

; 297  :         c->lit2_r++;

	inc	DWORD PTR [rcx+176]

; 298  :     }
; 299  :     else

	jmp	SHORT $LN17@STORE_RUN
$LN7@STORE_RUN:
	mov	QWORD PTR [rsp+80], r13

; 300  :     {
; 301  :         lzo_uint tt = t - 18;

	lea	r13, QWORD PTR [r9-18]

; 302  : 
; 303  :         *op++ = 0;

	mov	BYTE PTR [rdx], 0

; 304  :         while (tt > 255)

	cmp	r13, 255				; 000000ffH
	jbe	SHORT $LN5@STORE_RUN

; 300  :     {
; 301  :         lzo_uint tt = t - 18;

	mov	QWORD PTR [rsp+64], rbx
	lea	rcx, QWORD PTR [r13-256]
	mov	rax, -9187201950435737471		; 8080808080808081H
	mul	rcx
	mov	rbx, rdx
	xor	edx, edx
	shr	rbx, 7
	mov	rcx, rdi
	inc	rbx
	mov	r8, rbx
	call	memset

; 304  :         while (tt > 255)

	add	rdi, rbx
	imul	rbx, -255				; ffffffffffffff01H
	add	r13, rbx
	mov	rbx, QWORD PTR [rsp+64]
$LN5@STORE_RUN:

; 305  :         {
; 306  :             tt -= 255;
; 307  :             *op++ = 0;
; 308  :         }
; 309  :         assert(tt > 0);
; 310  :         *op++ = LZO_BYTE(tt);

	mov	BYTE PTR [rdi], r13b
	mov	r13, QWORD PTR [rsp+80]
	inc	rdi

; 311  :         c->lit3_r++;

	inc	DWORD PTR [rbp+180]
$LN17@STORE_RUN:

; 312  :     }
; 313  :     do *op++ = *ii++; while (--t > 0);

	mov	rbp, QWORD PTR [rsp+72]
	sub	r12, rdi
	npad	12
$LL3@STORE_RUN:
	movzx	eax, BYTE PTR [r12+rdi]
	inc	rdi
	dec	rsi
	mov	BYTE PTR [rdi-1], al
	jne	SHORT $LL3@STORE_RUN

; 314  : 
; 315  :     return op;

	mov	rax, rdi

; 316  : }

	add	rsp, 32					; 00000020H
	pop	r12
	pop	rdi
	pop	rsi
	ret	0
?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z ENDP	; STORE_RUN
_TEXT	ENDS
pdata	SEGMENT
$pdata$?code_match@@YAPEAEPEAUlzo1x_999_t@@PEAE_K2@Z DD imagerel ?code_match@@YAPEAEPEAUlzo1x_999_t@@PEAE_K2@Z
	DD	imagerel ?code_match@@YAPEAEPEAUlzo1x_999_t@@PEAE_K2@Z+220
	DD	imagerel $unwind$?code_match@@YAPEAEPEAUlzo1x_999_t@@PEAE_K2@Z
$pdata$0$?code_match@@YAPEAEPEAUlzo1x_999_t@@PEAE_K2@Z DD imagerel ?code_match@@YAPEAEPEAUlzo1x_999_t@@PEAE_K2@Z+220
	DD	imagerel ?code_match@@YAPEAEPEAUlzo1x_999_t@@PEAE_K2@Z+538
	DD	imagerel $chain$0$?code_match@@YAPEAEPEAUlzo1x_999_t@@PEAE_K2@Z
$pdata$1$?code_match@@YAPEAEPEAUlzo1x_999_t@@PEAE_K2@Z DD imagerel ?code_match@@YAPEAEPEAUlzo1x_999_t@@PEAE_K2@Z+538
	DD	imagerel ?code_match@@YAPEAEPEAUlzo1x_999_t@@PEAE_K2@Z+577
	DD	imagerel $chain$1$?code_match@@YAPEAEPEAUlzo1x_999_t@@PEAE_K2@Z
pdata	ENDS
xdata	SEGMENT
$unwind$?code_match@@YAPEAEPEAUlzo1x_999_t@@PEAE_K2@Z DD 0a1901H
	DD	0b7419H
	DD	0a6419H
	DD	095419H
	DD	0e0153219H
	DD	0c011d013H
$chain$0$?code_match@@YAPEAEPEAUlzo1x_999_t@@PEAE_K2@Z DD 020521H
	DD	083405H
	DD	imagerel ?code_match@@YAPEAEPEAUlzo1x_999_t@@PEAE_K2@Z
	DD	imagerel ?code_match@@YAPEAEPEAUlzo1x_999_t@@PEAE_K2@Z+220
	DD	imagerel $unwind$?code_match@@YAPEAEPEAUlzo1x_999_t@@PEAE_K2@Z
$chain$1$?code_match@@YAPEAEPEAUlzo1x_999_t@@PEAE_K2@Z DD 021H
	DD	imagerel ?code_match@@YAPEAEPEAUlzo1x_999_t@@PEAE_K2@Z
	DD	imagerel ?code_match@@YAPEAEPEAUlzo1x_999_t@@PEAE_K2@Z+220
	DD	imagerel $unwind$?code_match@@YAPEAEPEAUlzo1x_999_t@@PEAE_K2@Z
; Function compile flags: /Ogtpy
xdata	ENDS
_TEXT	SEGMENT
c$ = 64
op$ = 72
m_len$ = 80
m_off$ = 88
?code_match@@YAPEAEPEAUlzo1x_999_t@@PEAE_K2@Z PROC	; code_match

; 119  : {

	mov	QWORD PTR [rsp+16], rbp
	mov	QWORD PTR [rsp+24], rsi
	mov	QWORD PTR [rsp+32], rdi
	push	r12
	push	r13
	push	r14
	sub	rsp, 32					; 00000020H

; 120  :     lzo_uint x_len = m_len;
; 121  :     lzo_uint x_off = m_off;
; 122  : 
; 123  :     c->match_bytes += (unsigned long) m_len;

	add	DWORD PTR [rcx+124], r8d
	mov	rbp, r9
	mov	rsi, r8
	mov	rdi, rdx
	mov	r12, rcx
	mov	r13, r8
	mov	r14, r9

; 124  : 
; 125  : #if 0
; 126  : /*
; 127  :     static lzo_uint last_m_len = 0, last_m_off = 0;
; 128  :     static lzo_uint prev_m_off[4];
; 129  :     static int prev_m_off_ptr = 0;
; 130  :     int i;
; 131  : 
; 132  :     //if (m_len >= 3 && m_len <= M2_MAX_LEN && m_off <= M2_MAX_OFFSET)
; 133  :     if (m_len >= 3 && m_len <= M2_MAX_LEN)
; 134  :     {
; 135  :     //if (m_len == last_m_len && m_off == last_m_off)
; 136  :         //printf("last_m_len + last_m_off\n");
; 137  :     //else
; 138  :     if (m_off == last_m_off)
; 139  :         printf("last_m_off\n");
; 140  :     else
; 141  :     {
; 142  :         for (i = 0; i < 4; i++)
; 143  :             if (m_off == prev_m_off[i])
; 144  :                 printf("prev_m_off %d: %5ld\n",i,(long)m_off);
; 145  :     }
; 146  :     }
; 147  :     last_m_len = m_len;
; 148  :     last_m_off = prev_m_off[prev_m_off_ptr] = m_off;
; 149  :     prev_m_off_ptr = (prev_m_off_ptr + 1) & 3;
; 150  : */
; 151  : #endif
; 152  : 
; 153  :     assert(op > c->out);
; 154  :     if (m_len == 2)

	cmp	r8, 2
	jne	SHORT $LN16@code_match

; 155  :     {
; 156  :         assert(m_off <= M1_MAX_OFFSET);
; 157  :         assert(c->r1_lit > 0); assert(c->r1_lit < 4);
; 158  :         m_off -= 1;

	dec	rbp

; 159  : #if defined(LZO1Z)
; 160  :         *op++ = LZO_BYTE(M1_MARKER | (m_off >> 6));
; 161  :         *op++ = LZO_BYTE(m_off << 2);
; 162  : #else
; 163  :         *op++ = LZO_BYTE(M1_MARKER | ((m_off & 3) << 2));
; 164  :         *op++ = LZO_BYTE(m_off >> 2);

	add	rdi, r8
	movzx	eax, bpl
	shr	rbp, 2
	and	al, 3
	shl	al, 2
	mov	BYTE PTR [rdx], al
	mov	BYTE PTR [rdx+1], bpl

; 165  : #endif
; 166  :         c->m1a_m++;

	inc	DWORD PTR [rcx+152]
	jmp	$LN5@code_match
$LN16@code_match:

; 167  :     }
; 168  : #if defined(LZO1Z)
; 169  :     else if (m_len <= M2_MAX_LEN && (m_off <= M2_MAX_OFFSET || m_off == c->last_m_off))
; 170  : #else
; 171  :     else if (m_len <= M2_MAX_LEN && m_off <= M2_MAX_OFFSET)

	cmp	r8, 8
	ja	SHORT $LN14@code_match
	cmp	r9, 2048				; 00000800H
	ja	SHORT $LN14@code_match

; 172  : #endif
; 173  :     {
; 174  :         assert(m_len >= 3);
; 175  : #if defined(LZO1X)
; 176  :         m_off -= 1;
; 177  :         *op++ = LZO_BYTE(((m_len - 1) << 5) | ((m_off & 7) << 2));

	dec	sil
	dec	rbp

; 178  :         *op++ = LZO_BYTE(m_off >> 3);

	add	rdi, 2
	shl	sil, 3
	movzx	eax, bpl
	shr	rbp, 3
	and	al, 7
	or	sil, al
	shl	sil, 2
	mov	BYTE PTR [rdx], sil
	mov	BYTE PTR [rdx+1], bpl

; 179  :         assert(op[-2] >= M2_MARKER);
; 180  : #elif defined(LZO1Y)
; 181  :         m_off -= 1;
; 182  :         *op++ = LZO_BYTE(((m_len + 1) << 4) | ((m_off & 3) << 2));
; 183  :         *op++ = LZO_BYTE(m_off >> 2);
; 184  :         assert(op[-2] >= M2_MARKER);
; 185  : #elif defined(LZO1Z)
; 186  :         if (m_off == c->last_m_off)
; 187  :             *op++ = LZO_BYTE(((m_len - 1) << 5) | (0x700 >> 6));
; 188  :         else
; 189  :         {
; 190  :             m_off -= 1;
; 191  :             *op++ = LZO_BYTE(((m_len - 1) << 5) | (m_off >> 6));
; 192  :             *op++ = LZO_BYTE(m_off << 2);
; 193  :         }
; 194  : #endif
; 195  :         c->m2_m++;

	inc	DWORD PTR [rcx+160]
	jmp	$LN5@code_match
$LN14@code_match:

; 196  :     }
; 197  :     else if (m_len == M2_MIN_LEN && m_off <= MX_MAX_OFFSET && c->r1_lit >= 4)

	cmp	r8, 3
	jne	SHORT $LN12@code_match
	cmp	r9, 3072				; 00000c00H
	ja	SHORT $LN12@code_match
	cmp	QWORD PTR [rcx+136], 4
	jb	SHORT $LN12@code_match

; 198  :     {
; 199  :         assert(m_len == 3);
; 200  :         assert(m_off > M2_MAX_OFFSET);
; 201  :         m_off -= 1 + M2_MAX_OFFSET;

	sub	rbp, 2049				; 00000801H

; 202  : #if defined(LZO1Z)
; 203  :         *op++ = LZO_BYTE(M1_MARKER | (m_off >> 6));
; 204  :         *op++ = LZO_BYTE(m_off << 2);
; 205  : #else
; 206  :         *op++ = LZO_BYTE(M1_MARKER | ((m_off & 3) << 2));
; 207  :         *op++ = LZO_BYTE(m_off >> 2);

	add	rdi, 2
	movzx	eax, bpl
	shr	rbp, 2
	and	al, r8b
	shl	al, 2
	mov	BYTE PTR [rdx], al
	mov	BYTE PTR [rdx+1], bpl

; 208  : #endif
; 209  :         c->m1b_m++;

	inc	DWORD PTR [rcx+156]
	jmp	$LN5@code_match
$LN12@code_match:
	mov	QWORD PTR [rsp+64], rbx

; 210  :     }
; 211  :     else if (m_off <= M3_MAX_OFFSET)

	cmp	r9, 16384				; 00004000H
	ja	$LN10@code_match

; 212  :     {
; 213  :         assert(m_len >= 3);
; 214  :         m_off -= 1;

	dec	rbp

; 215  :         if (m_len <= M3_MAX_LEN)

	cmp	r8, 33					; 00000021H
	ja	SHORT $LN9@code_match

; 216  :             *op++ = LZO_BYTE(M3_MARKER | (m_len - 2));

	sub	sil, 2
	or	sil, 32					; 00000020H
	mov	BYTE PTR [rdx], sil

; 217  :         else

	jmp	SHORT $LN24@code_match
$LN9@code_match:

; 218  :         {
; 219  :             m_len -= M3_MAX_LEN;

	sub	rsi, 33					; 00000021H

; 220  :             *op++ = M3_MARKER | 0;

	inc	rdi
	mov	BYTE PTR [rdx], 32			; 00000020H

; 221  :             while (m_len > 255)

	cmp	rsi, 255				; 000000ffH
	jbe	SHORT $LN7@code_match

; 218  :         {
; 219  :             m_len -= M3_MAX_LEN;

	lea	rcx, QWORD PTR [rsi-256]
	mov	rax, -9187201950435737471		; 8080808080808081H
	mul	rcx
	mov	rcx, rdi
	mov	rbx, rdx
	xor	edx, edx
	shr	rbx, 7
	inc	rbx
	mov	r8, rbx
	call	memset

; 221  :             while (m_len > 255)

	mov	r11, rbx
	imul	r11, -255				; ffffffffffffff01H
	add	rsi, r11
	add	rdi, rbx
$LN7@code_match:

; 222  :             {
; 223  :                 m_len -= 255;
; 224  :                 *op++ = 0;
; 225  :             }
; 226  :             assert(m_len > 0);
; 227  :             *op++ = LZO_BYTE(m_len);

	mov	BYTE PTR [rdi], sil
$LN24@code_match:
	inc	rdi

; 228  :         }
; 229  : #if defined(LZO1Z)
; 230  :         *op++ = LZO_BYTE(m_off >> 6);
; 231  :         *op++ = LZO_BYTE(m_off << 2);
; 232  : #else
; 233  :         *op++ = LZO_BYTE(m_off << 2);

	movzx	eax, bpl

; 234  :         *op++ = LZO_BYTE(m_off >> 6);

	shr	rbp, 6
	shl	al, 2
	add	rdi, 2
	mov	BYTE PTR [rdi-2], al
	mov	BYTE PTR [rdi-1], bpl

; 235  : #endif
; 236  :         c->m3_m++;

	inc	DWORD PTR [r12+164]

; 237  :     }
; 238  :     else

	jmp	$LN23@code_match
$LN10@code_match:

; 239  :     {
; 240  :         lzo_uint k;
; 241  : 
; 242  :         assert(m_len >= 3);
; 243  :         assert(m_off > 0x4000); assert(m_off <= 0xbfff);
; 244  :         m_off -= 0x4000;

	sub	rbp, 16384				; 00004000H

; 245  :         k = (m_off & 0x4000) >> 11;

	mov	rax, rbp
	shr	rax, 11
	and	eax, 8

; 246  :         if (m_len <= M4_MAX_LEN)

	cmp	r8, 9
	ja	SHORT $LN4@code_match

; 247  :             *op++ = LZO_BYTE(M4_MARKER | k | (m_len - 2));

	sub	sil, 2
	or	sil, al
	or	sil, 16
	mov	BYTE PTR [rdx], sil

; 248  :         else

	jmp	SHORT $LN25@code_match
$LN4@code_match:

; 251  :             *op++ = LZO_BYTE(M4_MARKER | k | 0);

	or	al, 16
	sub	rsi, 9
	inc	rdi
	mov	BYTE PTR [rdx], al

; 252  :             while (m_len > 255)

	cmp	rsi, 255				; 000000ffH
	jbe	SHORT $LN2@code_match

; 249  :         {
; 250  :             m_len -= M4_MAX_LEN;

	lea	rcx, QWORD PTR [rsi-256]
	mov	rax, -9187201950435737471		; 8080808080808081H
	mul	rcx
	mov	rcx, rdi
	mov	rbx, rdx
	xor	edx, edx
	shr	rbx, 7
	inc	rbx
	mov	r8, rbx
	call	memset

; 252  :             while (m_len > 255)

	mov	r11, rbx
	imul	r11, -255				; ffffffffffffff01H
	add	rsi, r11
	add	rdi, rbx
$LN2@code_match:

; 253  :             {
; 254  :                 m_len -= 255;
; 255  :                 *op++ = 0;
; 256  :             }
; 257  :             assert(m_len > 0);
; 258  :             *op++ = LZO_BYTE(m_len);

	mov	BYTE PTR [rdi], sil
$LN25@code_match:
	inc	rdi

; 259  :         }
; 260  : #if defined(LZO1Z)
; 261  :         *op++ = LZO_BYTE(m_off >> 6);
; 262  :         *op++ = LZO_BYTE(m_off << 2);
; 263  : #else
; 264  :         *op++ = LZO_BYTE(m_off << 2);

	movzx	eax, bpl

; 265  :         *op++ = LZO_BYTE(m_off >> 6);

	shr	rbp, 6
	shl	al, 2
	add	rdi, 2
	mov	BYTE PTR [rdi-2], al
	mov	BYTE PTR [rdi-1], bpl

; 266  : #endif
; 267  :         c->m4_m++;

	inc	DWORD PTR [r12+168]
$LN23@code_match:
	mov	rbx, QWORD PTR [rsp+64]
$LN5@code_match:

; 268  :     }
; 269  : 
; 270  :     c->last_m_len = x_len;
; 271  :     c->last_m_off = x_off;
; 272  :     return op;
; 273  : }

	mov	rbp, QWORD PTR [rsp+72]
	mov	rsi, QWORD PTR [rsp+80]
	mov	rax, rdi
	mov	rdi, QWORD PTR [rsp+88]
	mov	QWORD PTR [r12+32], r13
	mov	QWORD PTR [r12+40], r14
	add	rsp, 32					; 00000020H
	pop	r14
	pop	r13
	pop	r12
	ret	0
?code_match@@YAPEAEPEAUlzo1x_999_t@@PEAE_K2@Z ENDP	; code_match
; Function compile flags: /Ogtpy
; File c:\users\nummer\documents\github\olr-3.0\src\xray\xrcore\rt_lzo_swd.ch
s$ = 8
?swd_search2@@YAHPEAUlzo1x_999_swd_t@@@Z PROC		; swd_search2

; 600  :     lzo_uint key;
; 601  : 
; 602  :     assert(s->look >= 2);
; 603  :     assert(s->m_len > 0);
; 604  : 
; 605  :     key = s_head2(s)[ HEAD2(s_b(s),s->bp) ];

	mov	rax, QWORD PTR [rcx+680]
	movzx	edx, WORD PTR [rax+rcx+728]
	movzx	r8d, WORD PTR [rcx+rdx*2+324308]

; 606  :     if (key == NIL2)

	cmp	r8, 65535				; 0000ffffH
	jne	SHORT $LN3@swd_search

; 607  :         return 0;

	xor	eax, eax

; 625  : }

	ret	0
$LN3@swd_search:

; 608  : #ifdef LZO_DEBUG
; 609  :     if (lzo_memcmp(&s_b(s)[s->bp],&s_b(s)[key],2) != 0)
; 610  :         printf("%5ld %5ld %02x%02x %02x%02x\n", (long)s->bp, (long)key,
; 611  :                 s_b(s)[s->bp], s_b(s)[s->bp+1], s_b(s)[key], s_b(s)[key+1]);
; 612  : #endif
; 613  :     assert(lzo_memcmp(&s_b(s)[s->bp],&s_b(s)[key],2) == 0);
; 614  : #if defined(SWD_BEST_OFF)
; 615  :     if (s->best_pos[2] == 0)

	cmp	QWORD PTR [rcx+392], 0
	jne	SHORT $LN2@swd_search

; 616  :         s->best_pos[2] = key + 1;

	lea	rax, QWORD PTR [r8+1]
	mov	QWORD PTR [rcx+392], rax
$LN2@swd_search:

; 617  : #endif
; 618  : 
; 619  :     if (s->m_len < 2)

	cmp	QWORD PTR [rcx+56], 2
	jae	SHORT $LN1@swd_search

; 620  :     {
; 621  :         s->m_len = 2;

	mov	QWORD PTR [rcx+56], 2

; 622  :         s->m_pos = key;

	mov	QWORD PTR [rcx+368], r8
$LN1@swd_search:

; 623  :     }
; 624  :     return 1;

	mov	eax, 1

; 625  : }

	ret	0
?swd_search2@@YAHPEAUlzo1x_999_swd_t@@@Z ENDP		; swd_search2
_TEXT	ENDS
pdata	SEGMENT
$pdata$?swd_search@@YAXPEAUlzo1x_999_swd_t@@_K1@Z DD imagerel ?swd_search@@YAXPEAUlzo1x_999_swd_t@@_K1@Z
	DD	imagerel ?swd_search@@YAXPEAUlzo1x_999_swd_t@@_K1@Z+280
	DD	imagerel $unwind$?swd_search@@YAXPEAUlzo1x_999_swd_t@@_K1@Z
pdata	ENDS
xdata	SEGMENT
$unwind$?swd_search@@YAXPEAUlzo1x_999_swd_t@@_K1@Z DD 060f01H
	DD	03740fH
	DD	02640aH
	DD	013405H
; Function compile flags: /Ogtpy
xdata	ENDS
_TEXT	SEGMENT
s$ = 8
node$ = 16
cnt$ = 24
?swd_search@@YAXPEAUlzo1x_999_swd_t@@_K1@Z PROC		; swd_search

; 515  : {

	mov	QWORD PTR [rsp+8], rbx
	mov	QWORD PTR [rsp+16], rsi
	mov	QWORD PTR [rsp+24], rdi

; 516  :     const lzo_bytep p1;
; 517  :     const lzo_bytep p2;
; 518  :     const lzo_bytep px;
; 519  :     lzo_uint m_len = s->m_len;
; 520  :     const lzo_bytep b  = s_b(s);
; 521  :     const lzo_bytep bp = s_b(s) + s->bp;

	mov	r9, QWORD PTR [rcx+680]

; 522  :     const lzo_bytep bx = s_b(s) + s->bp + s->look;

	mov	rax, QWORD PTR [rcx+72]
	mov	rbx, QWORD PTR [rcx+56]
	mov	rsi, r8
	lea	r8, QWORD PTR [r9+rcx+728]
	add	rax, r9

; 523  :     unsigned char scan_end1;
; 524  : 
; 525  :     assert(s->m_len > 0);
; 526  : 
; 527  :     scan_end1 = bp[m_len - 1];

	movzx	edi, BYTE PTR [r8+rbx-1]
	mov	r11, rdx
	mov	r10, rcx
	lea	r9, QWORD PTR [rax+rcx+728]

; 528  :     for ( ; cnt-- > 0; node = s_succ3(s)[node])

	test	rsi, rsi
	je	$LN24@swd_search@2
	npad	7
$LL14@swd_search@2:

; 529  :     {
; 530  :         p1 = bp;
; 531  :         p2 = b + node;

	lea	rdx, QWORD PTR [r10+r11+728]
	dec	rsi

; 532  :         px = bx;
; 533  : 
; 534  :         assert(m_len < s->look);
; 535  : 
; 536  :         if (
; 537  : #if 1
; 538  :             p2[m_len - 1] == scan_end1 &&
; 539  :             p2[m_len] == p1[m_len] &&
; 540  : #endif
; 541  :             p2[0] == p1[0] &&
; 542  :             p2[1] == p1[1])

	cmp	BYTE PTR [rdx+rbx-1], dil
	jne	$LN13@swd_search@2
	movzx	eax, BYTE PTR [r8+rbx]
	cmp	BYTE PTR [rdx+rbx], al
	jne	$LN13@swd_search@2
	movzx	eax, BYTE PTR [r8]
	cmp	BYTE PTR [rdx], al
	jne	SHORT $LN13@swd_search@2
	movzx	eax, BYTE PTR [r8+1]
	cmp	BYTE PTR [rdx+1], al
	jne	SHORT $LN13@swd_search@2

; 543  :         {
; 544  :             lzo_uint i;
; 545  :             assert(lzo_memcmp(bp,&b[node],3) == 0);
; 546  : 
; 547  : #if 0 && defined(LZO_UNALIGNED_OK_4)
; 548  :             p1 += 3; p2 += 3;
; 549  :             while (p1 < px && * (const lzo_uint32p) p1 == * (const lzo_uint32p) p2)
; 550  :                 p1 += 4, p2 += 4;
; 551  :             while (p1 < px && *p1 == *p2)
; 552  :                 p1 += 1, p2 += 1;
; 553  : #else
; 554  :             p1 += 2; p2 += 2;

	lea	rcx, QWORD PTR [r8+2]
	add	rdx, 2
	npad	2
$LL10@swd_search@2:

; 555  :             do {} while (++p1 < px && *p1 == *++p2);

	inc	rcx
	cmp	rcx, r9
	jae	SHORT $LN7@swd_search@2
	movzx	eax, BYTE PTR [rdx+1]
	inc	rdx
	cmp	BYTE PTR [rcx], al
	je	SHORT $LL10@swd_search@2
$LN7@swd_search@2:

; 556  : #endif
; 557  :             i = pd(p1, bp);

	sub	rcx, r8

; 558  : 
; 559  : #ifdef LZO_DEBUG
; 560  :             if (lzo_memcmp(bp,&b[node],i) != 0)
; 561  :                 printf("%5ld %5ld %02x%02x %02x%02x\n",
; 562  :                         (long)s->bp, (long) node,
; 563  :                         bp[0], bp[1], b[node], b[node+1]);
; 564  : #endif
; 565  :             assert(lzo_memcmp(bp,&b[node],i) == 0);
; 566  : 
; 567  : #if defined(SWD_BEST_OFF)
; 568  :             if (i < SWD_BEST_OFF)

	cmp	rcx, 34					; 00000022H
	jae	SHORT $LN5@swd_search@2

; 569  :             {
; 570  :                 if (s->best_pos[i] == 0)

	cmp	QWORD PTR [r10+rcx*8+376], 0
	jne	SHORT $LN5@swd_search@2

; 571  :                     s->best_pos[i] = node + 1;

	lea	rax, QWORD PTR [r11+1]
	mov	QWORD PTR [r10+rcx*8+376], rax
$LN5@swd_search@2:

; 572  :             }
; 573  : #endif
; 574  :             if (i > m_len)

	cmp	rcx, rbx
	jbe	SHORT $LN13@swd_search@2

; 575  :             {
; 576  :                 s->m_len = m_len = i;

	mov	rbx, rcx
	mov	QWORD PTR [r10+56], rcx

; 577  :                 s->m_pos = node;

	mov	QWORD PTR [r10+368], r11

; 578  :                 if (m_len == s->look)

	cmp	rcx, QWORD PTR [r10+72]
	je	SHORT $LN24@swd_search@2

; 579  :                     return;
; 580  :                 if (m_len >= s->nice_length)

	cmp	rcx, QWORD PTR [r10+32]
	jae	SHORT $LN24@swd_search@2

; 581  :                     return;
; 582  :                 if (m_len > (lzo_uint) s_best3(s)[node])

	movzx	eax, WORD PTR [r10+r11*2+189142]
	cmp	rcx, rax
	ja	SHORT $LN24@swd_search@2

; 583  :                     return;
; 584  :                 scan_end1 = bp[m_len - 1];

	movzx	edi, BYTE PTR [rcx+r8-1]
$LN13@swd_search@2:

; 528  :     for ( ; cnt-- > 0; node = s_succ3(s)[node])

	movzx	r11d, WORD PTR [r10+r11*2+86744]
	test	rsi, rsi
	jne	$LL14@swd_search@2
$LN24@swd_search@2:

; 585  :             }
; 586  :         }
; 587  :     }
; 588  : }

	mov	rbx, QWORD PTR [rsp+8]
	mov	rsi, QWORD PTR [rsp+16]
	mov	rdi, QWORD PTR [rsp+24]
	ret	0
?swd_search@@YAXPEAUlzo1x_999_swd_t@@_K1@Z ENDP		; swd_search
; Function compile flags: /Ogtpy
s$ = 8
node$ = 16
?swd_remove_node@@YAXPEAUlzo1x_999_swd_t@@_K@Z PROC	; swd_remove_node

; 443  :     if (s->node_count == 0)

	mov	rax, QWORD PTR [rcx+712]
	test	rax, rax
	jne	SHORT $LN3@swd_remove

; 444  :     {
; 445  :         lzo_uint key;
; 446  : 
; 447  : #ifdef LZO_DEBUG
; 448  :         if (s->first_rp != LZO_UINT_MAX)
; 449  :         {
; 450  :             if (node != s->first_rp)
; 451  :                 printf("Remove %5u: %5u %5u %5u %5u  %6u %6u\n",
; 452  :                         node, s->rp, s->ip, s->bp, s->first_rp,
; 453  :                         s->ip - node, s->ip - s->bp);
; 454  :             assert(node == s->first_rp);
; 455  :             s->first_rp = LZO_UINT_MAX;
; 456  :         }
; 457  : #endif
; 458  : 
; 459  :         key = HEAD3(s_b(s),node);

	movzx	eax, BYTE PTR [rcx+rdx+729]
	movzx	r8d, BYTE PTR [rcx+rdx+728]

; 460  :         assert(s_llen3(s)[key] > 0);
; 461  :         --s_llen3(s)[key];

	mov	r9d, 65535				; 0000ffffH
	shl	r8, 5
	xor	r8, rax
	movzx	eax, BYTE PTR [rcx+rdx+730]
	shl	r8, 5
	xor	r8, rax
	imul	r8, 40799				; 00009f5fH
	shr	r8, 5
	and	r8d, 16383				; 00003fffH
	add	WORD PTR [rcx+r8*2+291540], r9w

; 462  : 
; 463  : #ifdef HEAD2
; 464  :         key = HEAD2(s_b(s),node);

	movzx	r8d, WORD PTR [rcx+rdx+728]

; 465  :         assert(s_head2(s)[key] != NIL2);
; 466  :         if ((lzo_uint) s_head2(s)[key] == node)

	movzx	eax, WORD PTR [rcx+r8*2+324308]
	cmp	rax, rdx
	jne	SHORT $LN1@swd_remove

; 467  :             s_head2(s)[key] = NIL2;

	mov	WORD PTR [rcx+r8*2+324308], r9w

; 472  : }

	ret	0
$LN3@swd_remove:

; 468  : #endif
; 469  :     }
; 470  :     else
; 471  :         --s->node_count;

	dec	rax
	mov	QWORD PTR [rcx+712], rax
$LN1@swd_remove:

; 472  : }

	fatret	0
?swd_remove_node@@YAXPEAUlzo1x_999_swd_t@@_K@Z ENDP	; swd_remove_node
; Function compile flags: /Ogtpy
s$ = 8
?swd_getbyte@@YAXPEAUlzo1x_999_swd_t@@@Z PROC		; swd_getbyte

; 407  : {

	mov	rdx, rcx

; 408  :     int c;
; 409  : 
; 410  :     if ((c = getbyte(*(s->c))) < 0)

	mov	rcx, QWORD PTR [rcx+360]
	mov	rax, QWORD PTR [rcx+72]
	cmp	QWORD PTR [rcx+56], rax
	jae	SHORT $LN12@swd_getbyt
	mov	rax, QWORD PTR [rcx+56]
	inc	rax
	movzx	r8d, BYTE PTR [rax-1]
	mov	QWORD PTR [rcx+56], rax
	test	r8d, r8d
	js	SHORT $LN12@swd_getbyt

; 414  : #if defined(__LZO_CHECKER)
; 415  :         /* initialize memory - value doesn't matter */
; 416  :         s_b(s)[s->ip] = 0;
; 417  :         if (s->ip < s->f)
; 418  :             s->b_wrap[s->ip] = 0;
; 419  : #endif
; 420  :     }
; 421  :     else
; 422  :     {
; 423  :         s_b(s)[s->ip] = LZO_BYTE(c);

	mov	rax, QWORD PTR [rdx+672]
	mov	BYTE PTR [rax+rdx+728], r8b

; 424  :         if (s->ip < s->f)

	mov	rcx, QWORD PTR [rdx+672]
	cmp	rcx, QWORD PTR [rdx+8]
	jae	SHORT $LN4@swd_getbyt

; 425  :             s->b_wrap[s->ip] = LZO_BYTE(c);

	mov	rax, QWORD PTR [rdx+704]
	mov	BYTE PTR [rcx+rax], r8b
	jmp	SHORT $LN4@swd_getbyt
$LN12@swd_getbyt:

; 411  :     {
; 412  :         if (s->look > 0)

	mov	rax, QWORD PTR [rdx+72]
	test	rax, rax
	je	SHORT $LN4@swd_getbyt

; 413  :             --s->look;

	dec	rax
	mov	QWORD PTR [rdx+72], rax
$LN4@swd_getbyt:

; 426  :     }
; 427  :     if (++s->ip == s->b_size)

	inc	QWORD PTR [rdx+672]
	mov	rcx, QWORD PTR [rdx+696]
	mov	rax, QWORD PTR [rdx+672]
	xor	r8d, r8d
	cmp	rax, rcx
	cmove	rax, r8

; 428  :         s->ip = 0;
; 429  :     if (++s->bp == s->b_size)

	inc	QWORD PTR [rdx+680]
	mov	QWORD PTR [rdx+672], rax
	mov	rax, QWORD PTR [rdx+680]
	cmp	rax, rcx
	cmove	rax, r8

; 430  :         s->bp = 0;
; 431  :     if (++s->rp == s->b_size)

	inc	QWORD PTR [rdx+688]
	mov	QWORD PTR [rdx+680], rax
	mov	rax, QWORD PTR [rdx+688]
	cmp	rax, rcx
	cmove	rax, r8
	mov	QWORD PTR [rdx+688], rax

; 432  :         s->rp = 0;
; 433  : }

	ret	0
?swd_getbyte@@YAXPEAUlzo1x_999_swd_t@@@Z ENDP		; swd_getbyte
; Function compile flags: /Ogtpy
?swd_exit@@YAXPEAUlzo1x_999_swd_t@@@Z PROC		; swd_exit

; 381  : #if defined(__LZO_CHECKER)
; 382  :     /* free in reverse order of allocations */
; 383  : #ifdef HEAD2
; 384  :     free(s->head2); s->head2 = NULL;
; 385  : #endif
; 386  :     free(s->llen3); s->llen3 = NULL;
; 387  :     free(s->best3); s->best3 = NULL;
; 388  :     free(s->succ3); s->succ3 = NULL;
; 389  :     free(s->head3); s->head3 = NULL;
; 390  :     free(s->b); s->b = NULL;
; 391  : #else
; 392  :     LZO_UNUSED(s);
; 393  : #endif
; 394  : }

	ret	0
?swd_exit@@YAXPEAUlzo1x_999_swd_t@@@Z ENDP		; swd_exit
_TEXT	ENDS
pdata	SEGMENT
$pdata$?swd_insertdict@@YAXPEAUlzo1x_999_swd_t@@_K1@Z DD imagerel ?swd_insertdict@@YAXPEAUlzo1x_999_swd_t@@_K1@Z
	DD	imagerel ?swd_insertdict@@YAXPEAUlzo1x_999_swd_t@@_K1@Z+43
	DD	imagerel $unwind$?swd_insertdict@@YAXPEAUlzo1x_999_swd_t@@_K1@Z
$pdata$2$?swd_insertdict@@YAXPEAUlzo1x_999_swd_t@@_K1@Z DD imagerel ?swd_insertdict@@YAXPEAUlzo1x_999_swd_t@@_K1@Z+43
	DD	imagerel ?swd_insertdict@@YAXPEAUlzo1x_999_swd_t@@_K1@Z+236
	DD	imagerel $chain$2$?swd_insertdict@@YAXPEAUlzo1x_999_swd_t@@_K1@Z
$pdata$3$?swd_insertdict@@YAXPEAUlzo1x_999_swd_t@@_K1@Z DD imagerel ?swd_insertdict@@YAXPEAUlzo1x_999_swd_t@@_K1@Z+236
	DD	imagerel ?swd_insertdict@@YAXPEAUlzo1x_999_swd_t@@_K1@Z+241
	DD	imagerel $chain$3$?swd_insertdict@@YAXPEAUlzo1x_999_swd_t@@_K1@Z
pdata	ENDS
xdata	SEGMENT
$unwind$?swd_insertdict@@YAXPEAUlzo1x_999_swd_t@@_K1@Z DD 010401H
	DD	0204H
$chain$2$?swd_insertdict@@YAXPEAUlzo1x_999_swd_t@@_K1@Z DD 061c21H
	DD	0741cH
	DD	036418H
	DD	023405H
	DD	imagerel ?swd_insertdict@@YAXPEAUlzo1x_999_swd_t@@_K1@Z
	DD	imagerel ?swd_insertdict@@YAXPEAUlzo1x_999_swd_t@@_K1@Z+43
	DD	imagerel $unwind$?swd_insertdict@@YAXPEAUlzo1x_999_swd_t@@_K1@Z
$chain$3$?swd_insertdict@@YAXPEAUlzo1x_999_swd_t@@_K1@Z DD 021H
	DD	imagerel ?swd_insertdict@@YAXPEAUlzo1x_999_swd_t@@_K1@Z
	DD	imagerel ?swd_insertdict@@YAXPEAUlzo1x_999_swd_t@@_K1@Z+43
	DD	imagerel $unwind$?swd_insertdict@@YAXPEAUlzo1x_999_swd_t@@_K1@Z
; Function compile flags: /Ogtpy
xdata	ENDS
_TEXT	SEGMENT
s$ = 16
len$ = 24
?swd_insertdict@@YAXPEAUlzo1x_999_swd_t@@_K1@Z PROC	; swd_insertdict

; 248  : {

	sub	rsp, 8

; 249  :     lzo_uint key;
; 250  : 
; 251  :     s->node_count = s->n - len;

	mov	rax, QWORD PTR [rcx]
	mov	r9, rdx
	mov	r8, rcx
	sub	rax, rdx

; 252  :     s->first_rp = node;

	mov	QWORD PTR [rcx+720], 0
	mov	QWORD PTR [rcx+712], rax

; 253  : 
; 254  :     while (len-- > 0)

	test	rdx, rdx
	je	$LN6@swd_insert
	mov	QWORD PTR [rsp+16], rbx
	lea	r10, QWORD PTR [rcx+728]
	lea	r11, QWORD PTR [rcx+730]
	mov	QWORD PTR [rsp+24], rsi
	mov	QWORD PTR [rsp], rdi
	mov	rbx, rcx
	sub	rbx, r11
	mov	rdi, r10
	sub	r11, r10
	neg	rdi

; 257  :         s_succ3(s)[node] = s_get_head3(s,key);

	lea	rsi, QWORD PTR [rcx+189142]
	npad	3
$LL2@swd_insert:

; 255  :     {
; 256  :         key = HEAD3(s_b(s),node);

	movzx	eax, BYTE PTR [r10]
	lea	rcx, QWORD PTR [r11+r10]

; 258  :         s_head3(s)[key] = SWD_UINT(node);
; 259  :         s_best3(s)[node] = SWD_UINT(s->f + 1);
; 260  :         s_llen3(s)[key]++;
; 261  :         assert(s_llen3(s)[key] <= SWD_N);
; 262  : 
; 263  : #ifdef HEAD2
; 264  :         key = HEAD2(s_b(s),node);
; 265  :         s_head2(s)[key] = SWD_UINT(node);
; 266  : #endif
; 267  : 
; 268  :         node++;

	add	rsi, 2
	movzx	edx, BYTE PTR [rcx+rbx+729]
	shl	rax, 5
	xor	rdx, rax
	movzx	eax, BYTE PTR [rcx]
	lea	ecx, DWORD PTR [r10+rdi]
	shl	rdx, 5
	inc	r10
	xor	rdx, rax
	imul	rdx, 40799				; 00009f5fH
	shr	rdx, 5
	and	edx, 16383				; 00003fffH
	movzx	eax, WORD PTR [r8+rdx*2+53976]
	mov	WORD PTR [rsi-102400], ax
	mov	WORD PTR [r8+rdx*2+53976], cx
	movzx	eax, WORD PTR [r8+8]
	inc	ax
	mov	WORD PTR [rsi-2], ax
	inc	WORD PTR [r8+rdx*2+291540]
	dec	r9
	movzx	eax, WORD PTR [r10-1]
	mov	WORD PTR [r8+rax*2+324308], cx
	jne	SHORT $LL2@swd_insert
	mov	rdi, QWORD PTR [rsp]
	mov	rsi, QWORD PTR [rsp+24]
	mov	rbx, QWORD PTR [rsp+16]
$LN6@swd_insert:

; 269  :     }
; 270  : }

	add	rsp, 8
	ret	0
?swd_insertdict@@YAXPEAUlzo1x_999_swd_t@@_K1@Z ENDP	; swd_insertdict
_TEXT	ENDS
pdata	SEGMENT
$pdata$?swd_initdict@@YAXPEAUlzo1x_999_swd_t@@PEBE_K@Z DD imagerel ?swd_initdict@@YAXPEAUlzo1x_999_swd_t@@PEBE_K@Z
	DD	imagerel ?swd_initdict@@YAXPEAUlzo1x_999_swd_t@@PEBE_K@Z+124
	DD	imagerel $unwind$?swd_initdict@@YAXPEAUlzo1x_999_swd_t@@PEBE_K@Z
pdata	ENDS
xdata	SEGMENT
$unwind$?swd_initdict@@YAXPEAUlzo1x_999_swd_t@@PEBE_K@Z DD 040a01H
	DD	06340aH
	DD	07006320aH
; Function compile flags: /Ogtpy
xdata	ENDS
_TEXT	SEGMENT
s$ = 48
dict$ = 56
dict_len$ = 64
?swd_initdict@@YAXPEAUlzo1x_999_swd_t@@PEBE_K@Z PROC	; swd_initdict

; 226  : {

	mov	QWORD PTR [rsp+8], rbx
	push	rdi
	sub	rsp, 32					; 00000020H

; 227  :     s->dict = s->dict_end = NULL;

	xor	eax, eax
	mov	rbx, r8
	mov	rdi, rcx
	mov	QWORD PTR [rcx+656], rax
	mov	QWORD PTR [rcx+648], rax

; 228  :     s->dict_len = 0;

	mov	QWORD PTR [rcx+664], rax

; 229  : 
; 230  :     if (!dict || dict_len <= 0)

	test	rdx, rdx
	je	SHORT $LN2@swd_initdi
	test	rbx, rbx
	je	SHORT $LN2@swd_initdi

; 231  :         return;
; 232  :     if (dict_len > s->n)

	mov	rax, QWORD PTR [rcx]
	cmp	rbx, rax
	jbe	SHORT $LN1@swd_initdi

; 233  :     {
; 234  :         dict += dict_len - s->n;

	sub	rbx, rax
	add	rdx, rbx

; 235  :         dict_len = s->n;

	mov	rbx, rax
$LN1@swd_initdi:

; 236  :     }
; 237  : 
; 238  :     s->dict = dict;
; 239  :     s->dict_len = dict_len;
; 240  :     s->dict_end = dict + dict_len;

	lea	rax, QWORD PTR [rdx+rbx]
	mov	QWORD PTR [rcx+648], rdx
	mov	QWORD PTR [rcx+664], rbx
	mov	QWORD PTR [rcx+656], rax

; 241  :     lzo_memcpy(s_b(s),dict,dict_len);

	add	rcx, 728				; 000002d8H
	mov	r8, rbx
	call	memcpy

; 242  :     s->ip = dict_len;

	mov	QWORD PTR [rdi+672], rbx
$LN2@swd_initdi:

; 243  : }

	mov	rbx, QWORD PTR [rsp+48]
	add	rsp, 32					; 00000020H
	pop	rdi
	ret	0
?swd_initdict@@YAXPEAUlzo1x_999_swd_t@@PEBE_K@Z ENDP	; swd_initdict
pdata	SEGMENT
$pdata$?code_run@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K3@Z DD imagerel ?code_run@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K3@Z
	DD	imagerel ?code_run@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K3@Z+86
	DD	imagerel $unwind$?code_run@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K3@Z
pdata	ENDS
xdata	SEGMENT
$unwind$?code_run@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K3@Z DD 040a01H
	DD	06340aH
	DD	07006320aH
; Function compile flags: /Ogtpy
; File c:\users\nummer\documents\github\olr-3.0\src\xray\xrcore\rt_lzo1x_9x.cpp
xdata	ENDS
_TEXT	SEGMENT
c$ = 48
op$ = 56
ii$ = 64
lit$ = 72
m_len$ = 80
?code_run@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K3@Z PROC	; code_run

; 322  : {

	mov	QWORD PTR [rsp+8], rbx
	push	rdi
	sub	rsp, 32					; 00000020H
	mov	rdi, r9
	mov	rbx, rcx

; 323  :     if (lit > 0)

	test	r9, r9
	je	SHORT $LN2@code_run

; 324  :     {
; 325  :         assert(m_len >= 2);
; 326  :         op = STORE_RUN(c,op,ii,lit);

	call	?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z ; STORE_RUN

; 327  :         c->r1_m_len = m_len;

	mov	rdx, QWORD PTR m_len$[rsp]

; 328  :         c->r1_lit = lit;

	mov	QWORD PTR [rbx+136], rdi
	mov	QWORD PTR [rbx+144], rdx

; 329  :     }
; 330  :     else
; 331  :     {
; 332  :         assert(m_len >= 3);
; 333  :         c->r1_m_len = 0;
; 334  :         c->r1_lit = 0;
; 335  :     }
; 336  : 
; 337  :     return op;
; 338  : }

	mov	rbx, QWORD PTR [rsp+48]
	add	rsp, 32					; 00000020H
	pop	rdi
	ret	0
$LN2@code_run:
	mov	rbx, QWORD PTR [rsp+48]
	xor	eax, eax
	mov	QWORD PTR [rcx+144], rax
	mov	QWORD PTR [rcx+136], rax
	mov	rax, rdx
	add	rsp, 32					; 00000020H
	pop	rdi
	ret	0
?code_run@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K3@Z ENDP	; code_run
_TEXT	ENDS
pdata	SEGMENT
$pdata$?swd_findbest@@YAXPEAUlzo1x_999_swd_t@@@Z DD imagerel ?swd_findbest@@YAXPEAUlzo1x_999_swd_t@@@Z
	DD	imagerel ?swd_findbest@@YAXPEAUlzo1x_999_swd_t@@@Z+649
	DD	imagerel $unwind$?swd_findbest@@YAXPEAUlzo1x_999_swd_t@@@Z
pdata	ENDS
xdata	SEGMENT
$unwind$?swd_findbest@@YAXPEAUlzo1x_999_swd_t@@@Z DD 060f01H
	DD	07640fH
	DD	06340fH
	DD	0700b320fH
; Function compile flags: /Ogtpy
; File c:\users\nummer\documents\github\olr-3.0\src\xray\xrcore\rt_lzo_swd.ch
xdata	ENDS
_TEXT	SEGMENT
s$ = 48
?swd_findbest@@YAXPEAUlzo1x_999_swd_t@@@Z PROC		; swd_findbest

; 636  : {

	mov	QWORD PTR [rsp+8], rbx
	mov	QWORD PTR [rsp+16], rsi
	push	rdi
	sub	rsp, 32					; 00000020H

; 637  :     lzo_uint key;
; 638  :     lzo_uint cnt, node;
; 639  :     lzo_uint len;
; 640  : 
; 641  :     assert(s->m_len > 0);
; 642  : 
; 643  :     /* get current head, add bp into HEAD3 */
; 644  :     key = HEAD3(s_b(s),s->bp);

	mov	rdx, QWORD PTR [rcx+680]
	mov	rbx, rcx
	movzx	ecx, BYTE PTR [rdx+rcx+728]
	movzx	eax, BYTE PTR [rdx+rbx+729]
	shl	rcx, 5
	xor	rcx, rax
	movzx	eax, BYTE PTR [rdx+rbx+730]
	shl	rcx, 5
	xor	rcx, rax
	imul	rcx, 40799				; 00009f5fH
	shr	rcx, 5
	and	ecx, 16383				; 00003fffH

; 645  :     node = s_succ3(s)[s->bp] = s_get_head3(s,key);

	movzx	eax, WORD PTR [rbx+rcx*2+53976]
	mov	WORD PTR [rbx+rdx*2+86744], ax
	mov	rax, QWORD PTR [rbx+680]

; 646  :     cnt = s_llen3(s)[key]++;

	movzx	r8d, WORD PTR [rbx+rcx*2+291540]
	movzx	r9d, WORD PTR [rbx+rax*2+86744]
	lea	eax, DWORD PTR [r8+1]
	mov	WORD PTR [rbx+rcx*2+291540], ax

; 647  :     assert(s_llen3(s)[key] <= SWD_N + SWD_F);
; 648  :     if (cnt > s->max_chain && s->max_chain > 0)

	mov	rax, QWORD PTR [rbx+24]
	cmp	r8, rax
	jbe	SHORT $LN13@swd_findbe
	test	rax, rax
	cmovne	r8, rax
$LN13@swd_findbe:

; 649  :         cnt = s->max_chain;
; 650  :     s_head3(s)[key] = SWD_UINT(s->bp);

	movzx	eax, WORD PTR [rbx+680]

; 651  : 
; 652  :     s->b_char = s_b(s)[s->bp];
; 653  :     len = s->m_len;
; 654  :     if (s->m_len >= s->look)

	mov	esi, 65535				; 0000ffffH
	mov	WORD PTR [rbx+rcx*2+53976], ax
	mov	rcx, QWORD PTR [rbx+680]
	mov	rdi, QWORD PTR [rbx+56]
	mov	rdx, QWORD PTR [rbx+72]
	movzx	eax, BYTE PTR [rcx+rbx+728]
	mov	DWORD PTR [rbx+80], eax
	cmp	rdi, rdx
	jb	SHORT $LN12@swd_findbe

; 655  :     {
; 656  :         if (s->look == 0)

	or	r8d, -1
	test	rdx, rdx
	cmove	eax, r8d

; 657  :             s->b_char = -1;
; 658  :         s->m_off = 0;

	xor	r10d, r10d
	mov	DWORD PTR [rbx+80], eax

; 659  :         s_best3(s)[s->bp] = SWD_UINT(s->f + 1);

	movzx	eax, WORD PTR [rbx+8]
	mov	QWORD PTR [rbx+64], r10
	inc	ax
	mov	WORD PTR [rbx+rcx*2+189142], ax

; 660  :     }
; 661  :     else

	jmp	$LN3@swd_findbe
$LN12@swd_findbe:

; 662  :     {
; 663  : #ifdef HEAD2
; 664  :         if (swd_search2(s))

	movzx	eax, WORD PTR [rcx+rbx+728]
	movzx	ecx, WORD PTR [rbx+rax*2+324308]
	cmp	rcx, rsi
	je	SHORT $LN8@swd_findbe
	cmp	QWORD PTR [rbx+392], 0
	jne	SHORT $LN21@swd_findbe
	lea	rax, QWORD PTR [rcx+1]
	mov	QWORD PTR [rbx+392], rax
$LN21@swd_findbe:
	cmp	rdi, 2
	jae	SHORT $LN20@swd_findbe
	mov	QWORD PTR [rbx+56], 2
	mov	QWORD PTR [rbx+368], rcx
$LN20@swd_findbe:

; 665  : #endif
; 666  :             if (s->look >= 3)

	cmp	rdx, 3
	jb	SHORT $LN8@swd_findbe

; 667  :                 swd_search(s,node,cnt);

	mov	rdx, r9
	mov	rcx, rbx
	call	?swd_search@@YAXPEAUlzo1x_999_swd_t@@_K1@Z ; swd_search
$LN8@swd_findbe:

; 668  :         if (s->m_len > len)

	cmp	QWORD PTR [rbx+56], rdi
	jbe	SHORT $LN7@swd_findbe

; 669  :             s->m_off = swd_pos2off(s,s->m_pos);

	mov	rcx, QWORD PTR [rbx+680]
	mov	rdx, QWORD PTR [rbx+368]
	cmp	rcx, rdx
	jbe	SHORT $LN16@swd_findbe
	sub	rcx, rdx
	jmp	SHORT $LN17@swd_findbe
$LN16@swd_findbe:
	mov	rax, QWORD PTR [rbx+696]
	sub	rax, rdx
	add	rcx, rax
$LN17@swd_findbe:
	mov	QWORD PTR [rbx+64], rcx
$LN7@swd_findbe:

; 670  :         s_best3(s)[s->bp] = SWD_UINT(s->m_len);

	mov	rcx, QWORD PTR [rbx+680]
	movzx	eax, WORD PTR [rbx+56]
	mov	WORD PTR [rbx+rcx*2+189142], ax

; 671  : 
; 672  : #if defined(SWD_BEST_OFF)
; 673  :         if (s->use_best_off)

	cmp	DWORD PTR [rbx+40], 0
	je	SHORT $LN3@swd_findbe

; 674  :         {
; 675  :             int i;
; 676  :             for (i = 2; i < SWD_BEST_OFF; i++)

	lea	rdx, QWORD PTR [rbx+104]
	mov	r9d, 32					; 00000020H
	xor	r10d, r10d
	npad	10
$LL5@swd_findbe:

; 677  :                 if (s->best_pos[i] > 0)

	mov	r8, QWORD PTR [rdx+288]
	test	r8, r8
	je	SHORT $LN2@swd_findbe

; 678  :                     s->best_off[i] = swd_pos2off(s,s->best_pos[i]-1);

	mov	rcx, QWORD PTR [rbx+680]
	lea	rax, QWORD PTR [r8-1]
	cmp	rcx, rax
	jbe	SHORT $LN18@swd_findbe
	sub	rcx, r8
	inc	rcx
	mov	QWORD PTR [rdx], rcx

; 679  :                 else

	jmp	SHORT $LN4@swd_findbe
$LN18@swd_findbe:

; 678  :                     s->best_off[i] = swd_pos2off(s,s->best_pos[i]-1);

	mov	rax, QWORD PTR [rbx+696]
	sub	rax, r8
	lea	rcx, QWORD PTR [rax+rcx+1]
	mov	QWORD PTR [rdx], rcx

; 679  :                 else

	jmp	SHORT $LN4@swd_findbe
$LN2@swd_findbe:

; 680  :                     s->best_off[i] = 0;

	mov	QWORD PTR [rdx], r10
$LN4@swd_findbe:

; 674  :         {
; 675  :             int i;
; 676  :             for (i = 2; i < SWD_BEST_OFF; i++)

	add	rdx, 8
	dec	r9
	jne	SHORT $LL5@swd_findbe
$LN3@swd_findbe:

; 681  :         }
; 682  : #endif
; 683  :     }
; 684  : 
; 685  :     swd_remove_node(s,s->rp);

	mov	rax, QWORD PTR [rbx+712]
	mov	rdx, QWORD PTR [rbx+688]
	test	rax, rax
	jne	SHORT $LN27@swd_findbe
	movzx	eax, BYTE PTR [rdx+rbx+728]
	movzx	ecx, BYTE PTR [rdx+rbx+729]
	shl	rax, 5
	xor	rcx, rax
	movzx	eax, BYTE PTR [rdx+rbx+730]
	shl	rcx, 5
	xor	rcx, rax
	imul	rcx, 40799				; 00009f5fH
	shr	rcx, 5
	and	ecx, 16383				; 00003fffH
	add	WORD PTR [rbx+rcx*2+291540], si
	movzx	ecx, WORD PTR [rdx+rbx+728]
	movzx	eax, WORD PTR [rbx+rcx*2+324308]
	cmp	rax, rdx
	jne	SHORT $LN25@swd_findbe
	mov	WORD PTR [rbx+rcx*2+324308], si
	jmp	SHORT $LN25@swd_findbe
$LN27@swd_findbe:
	dec	rax
	mov	QWORD PTR [rbx+712], rax
$LN25@swd_findbe:

; 686  : 
; 687  : #ifdef HEAD2
; 688  :     /* add bp into HEAD2 */
; 689  :     key = HEAD2(s_b(s),s->bp);
; 690  :     s_head2(s)[key] = SWD_UINT(s->bp);

	mov	rax, QWORD PTR [rbx+680]

; 691  : #endif
; 692  : }

	mov	rsi, QWORD PTR [rsp+56]
	movzx	ecx, WORD PTR [rbx+rax+728]
	mov	WORD PTR [rbx+rcx*2+324308], ax
	mov	rbx, QWORD PTR [rsp+48]
	add	rsp, 32					; 00000020H
	pop	rdi
	ret	0
?swd_findbest@@YAXPEAUlzo1x_999_swd_t@@@Z ENDP		; swd_findbest
_TEXT	ENDS
pdata	SEGMENT
$pdata$?swd_accept@@YAXPEAUlzo1x_999_swd_t@@_K@Z DD imagerel ?swd_accept@@YAXPEAUlzo1x_999_swd_t@@_K@Z
	DD	imagerel ?swd_accept@@YAXPEAUlzo1x_999_swd_t@@_K@Z+345
	DD	imagerel $unwind$?swd_accept@@YAXPEAUlzo1x_999_swd_t@@_K@Z
pdata	ENDS
xdata	SEGMENT
$unwind$?swd_accept@@YAXPEAUlzo1x_999_swd_t@@_K@Z DD 010401H
	DD	04204H
; Function compile flags: /Ogtpy
xdata	ENDS
_TEXT	SEGMENT
s$ = 48
n$ = 56
?swd_accept@@YAXPEAUlzo1x_999_swd_t@@_K@Z PROC		; swd_accept

; 481  : {

	sub	rsp, 40					; 00000028H
	mov	r10, rdx
	mov	r9, rcx

; 482  :     assert(n <= s->look);
; 483  : 
; 484  :     while (n--)

	test	rdx, rdx
	je	$LN11@swd_accept
	mov	r11d, 65535				; 0000ffffH
	npad	7
$LL2@swd_accept:

; 485  :     {
; 486  :         lzo_uint key;
; 487  : 
; 488  :         swd_remove_node(s,s->rp);

	mov	rax, QWORD PTR [r9+712]
	mov	rdx, QWORD PTR [r9+688]
	dec	r10
	test	rax, rax
	jne	SHORT $LN7@swd_accept
	movzx	eax, BYTE PTR [rdx+r9+728]
	movzx	ecx, BYTE PTR [rdx+r9+729]
	shl	rax, 5
	xor	rcx, rax
	movzx	eax, BYTE PTR [rdx+r9+730]
	shl	rcx, 5
	xor	rcx, rax
	imul	rcx, 40799				; 00009f5fH
	shr	rcx, 5
	and	ecx, 16383				; 00003fffH
	add	WORD PTR [r9+rcx*2+291540], r11w
	movzx	ecx, WORD PTR [rdx+r9+728]
	movzx	eax, WORD PTR [r9+rcx*2+324308]
	cmp	rax, rdx
	jne	SHORT $LN5@swd_accept
	mov	WORD PTR [r9+rcx*2+324308], r11w
	jmp	SHORT $LN5@swd_accept
$LN7@swd_accept:
	dec	rax
	mov	QWORD PTR [r9+712], rax
$LN5@swd_accept:

; 489  : 
; 490  :         /* add bp into HEAD3 */
; 491  :         key = HEAD3(s_b(s),s->bp);

	mov	rcx, QWORD PTR [r9+680]
	movzx	eax, BYTE PTR [rcx+r9+729]
	movzx	edx, BYTE PTR [rcx+r9+728]
	shl	rdx, 5
	xor	rdx, rax
	movzx	eax, BYTE PTR [rcx+r9+730]
	shl	rdx, 5
	xor	rdx, rax
	imul	rdx, 40799				; 00009f5fH
	shr	rdx, 5
	and	edx, 16383				; 00003fffH

; 492  :         s_succ3(s)[s->bp] = s_get_head3(s,key);

	movzx	eax, WORD PTR [r9+rdx*2+53976]
	mov	WORD PTR [r9+rcx*2+86744], ax

; 493  :         s_head3(s)[key] = SWD_UINT(s->bp);

	movzx	eax, WORD PTR [r9+680]
	mov	WORD PTR [r9+rdx*2+53976], ax

; 494  :         s_best3(s)[s->bp] = SWD_UINT(s->f + 1);

	movzx	ecx, WORD PTR [r9+8]
	mov	rax, QWORD PTR [r9+680]
	inc	cx
	mov	WORD PTR [r9+rax*2+189142], cx

; 495  :         s_llen3(s)[key]++;

	inc	WORD PTR [r9+rdx*2+291540]

; 496  :         assert(s_llen3(s)[key] <= SWD_N);
; 497  : 
; 498  : #ifdef HEAD2
; 499  :         /* add bp into HEAD2 */
; 500  :         key = HEAD2(s_b(s),s->bp);
; 501  :         s_head2(s)[key] = SWD_UINT(s->bp);

	mov	rax, QWORD PTR [r9+680]
	movzx	ecx, WORD PTR [r9+rax+728]
	mov	WORD PTR [r9+rcx*2+324308], ax

; 502  : #endif
; 503  : 
; 504  :         swd_getbyte(s);

	mov	rcx, r9
	call	?swd_getbyte@@YAXPEAUlzo1x_999_swd_t@@@Z ; swd_getbyte
	test	r10, r10
	jne	$LL2@swd_accept
$LN11@swd_accept:

; 505  :     }
; 506  : }

	add	rsp, 40					; 00000028H
	ret	0
?swd_accept@@YAXPEAUlzo1x_999_swd_t@@_K@Z ENDP		; swd_accept
_TEXT	ENDS
pdata	SEGMENT
$pdata$?swd_init@@YAHPEAUlzo1x_999_swd_t@@PEBE_K@Z DD imagerel ?swd_init@@YAHPEAUlzo1x_999_swd_t@@PEBE_K@Z
	DD	imagerel ?swd_init@@YAHPEAUlzo1x_999_swd_t@@PEBE_K@Z+402
	DD	imagerel $unwind$?swd_init@@YAHPEAUlzo1x_999_swd_t@@PEBE_K@Z
pdata	ENDS
xdata	SEGMENT
$unwind$?swd_init@@YAHPEAUlzo1x_999_swd_t@@PEBE_K@Z DD 081401H
	DD	086414H
	DD	075414H
	DD	063414H
	DD	070103214H
; Function compile flags: /Ogtpy
xdata	ENDS
_TEXT	SEGMENT
s$ = 48
dict$ = 56
dict_len$ = 64
?swd_init@@YAHPEAUlzo1x_999_swd_t@@PEBE_K@Z PROC	; swd_init

; 279  : {

	mov	QWORD PTR [rsp+8], rbx
	mov	QWORD PTR [rsp+16], rbp
	mov	QWORD PTR [rsp+24], rsi
	push	rdi
	sub	rsp, 32					; 00000020H

; 280  :     lzo_uint i = 0;
; 281  :     int c = 0;
; 282  : 
; 283  : #if defined(__LZO_CHECKER)
; 284  :     s->b = malloc(SWD_N + SWD_F + SWD_F);
; 285  :     s->head3 = malloc(sizeof(swd_uint) * SWD_HSIZE);
; 286  :     s->succ3 = malloc(sizeof(swd_uint) * (SWD_N + SWD_F));
; 287  :     s->best3 = malloc(sizeof(swd_uint) * (SWD_N + SWD_F));
; 288  :     s->llen3 = malloc(sizeof(swd_uint) * SWD_HSIZE);
; 289  : #ifdef HEAD2
; 290  :     s->head2 = malloc(sizeof(swd_uint) * 65536L);
; 291  : #endif
; 292  : #endif
; 293  : 
; 294  :     s->n = SWD_N;
; 295  :     s->f = SWD_F;
; 296  :     s->threshold = SWD_THRESHOLD;
; 297  : 
; 298  :     /* defaults */
; 299  :     s->max_chain = SWD_MAX_CHAIN;
; 300  :     s->nice_length = SWD_F;
; 301  :     s->use_best_off = 0;
; 302  :     s->lazy_insert = 0;
; 303  : 
; 304  :     s->b_size = s->n + s->f;
; 305  : #if 0
; 306  :     if (2 * s->f >= s->n || s->b_size + s->f >= SWD_UINT_MAX)
; 307  :         return LZO_E_ERROR;
; 308  : #else
; 309  :     LZO_COMPILE_TIME_ASSERT(!(0ul + 2 * SWD_F >= SWD_N))
; 310  :     LZO_COMPILE_TIME_ASSERT(!(0ul + SWD_N + SWD_F + SWD_F >= SWD_UINT_MAX))
; 311  : #endif
; 312  :     s->b_wrap = s_b(s) + s->b_size;

	lea	rax, QWORD PTR [rcx+51927]
	xor	ebp, ebp
	mov	rbx, r8
	mov	rdi, rdx
	mov	rsi, rcx
	mov	QWORD PTR [rcx], 49151			; 0000bfffH
	mov	QWORD PTR [rcx+704], rax
	mov	QWORD PTR [rcx+8], 2048			; 00000800H
	mov	QWORD PTR [rcx+16], 1
	mov	QWORD PTR [rcx+24], 2048		; 00000800H
	mov	QWORD PTR [rcx+32], 2048		; 00000800H
	mov	DWORD PTR [rcx+40], ebp
	mov	QWORD PTR [rcx+48], rbp
	mov	QWORD PTR [rcx+696], 51199		; 0000c7ffH

; 313  :     s->node_count = s->n;

	mov	QWORD PTR [rcx+712], 49151		; 0000bfffH

; 314  : 
; 315  :     lzo_memset(s_llen3(s), 0, sizeof(s_llen3(s)[0]) * (lzo_uint)SWD_HSIZE);

	add	rcx, 291540				; 000472d4H
	xor	edx, edx
	mov	r8d, 32768				; 00008000H
	call	memset

; 316  : #ifdef HEAD2
; 317  : #if 1
; 318  :     lzo_memset(s_head2(s), 0xff, sizeof(s_head2(s)[0]) * 65536L);

	lea	rcx, QWORD PTR [rsi+324308]
	mov	edx, 255				; 000000ffH
	mov	r8d, 131072				; 00020000H
	call	memset

; 319  :     assert(s_head2(s)[0] == NIL2);
; 320  : #else
; 321  :     for (i = 0; i < 65536L; i++)
; 322  :         s_head2(s)[i] = NIL2;
; 323  : #endif
; 324  : #endif
; 325  : 
; 326  :     s->ip = 0;
; 327  :     swd_initdict(s,dict,dict_len);

	mov	r8, rbx
	mov	rdx, rdi
	mov	rcx, rsi
	mov	QWORD PTR [rsi+672], rbp
	call	?swd_initdict@@YAXPEAUlzo1x_999_swd_t@@PEBE_K@Z ; swd_initdict

; 328  :     s->bp = s->ip;

	mov	r11, QWORD PTR [rsi+672]

; 329  :     s->first_rp = s->ip;
; 330  : 
; 331  :     assert(s->ip + s->f <= s->b_size);
; 332  : #if 1
; 333  :     s->look = (lzo_uint) (s->c->in_end - s->c->ip);

	mov	rdx, QWORD PTR [rsi+360]
	mov	QWORD PTR [rsi+680], r11
	mov	QWORD PTR [rsi+720], r11
	mov	rcx, QWORD PTR [rdx+72]
	sub	rcx, QWORD PTR [rdx+56]
	mov	QWORD PTR [rsi+72], rcx

; 334  :     if (s->look > 0)

	je	SHORT $LN6@swd_init

; 335  :     {
; 336  :         if (s->look > s->f)

	mov	rax, QWORD PTR [rsi+8]
	cmp	rcx, rax
	jbe	SHORT $LN5@swd_init

; 337  :             s->look = s->f;

	mov	QWORD PTR [rsi+72], rax
$LN5@swd_init:

; 338  :         lzo_memcpy(&s_b(s)[s->ip],s->c->ip,s->look);

	mov	r8, QWORD PTR [rsi+72]
	mov	rdx, QWORD PTR [rdx+56]
	lea	rcx, QWORD PTR [r11+rsi+728]
	call	memcpy

; 339  :         s->c->ip += s->look;

	mov	rax, QWORD PTR [rsi+72]
	mov	r11, QWORD PTR [rsi+360]
	add	QWORD PTR [r11+56], rax

; 340  :         s->ip += s->look;

	mov	rax, QWORD PTR [rsi+72]
	add	QWORD PTR [rsi+672], rax
$LN6@swd_init:

; 341  :     }
; 342  : #else
; 343  :     s->look = 0;
; 344  :     while (s->look < s->f)
; 345  :     {
; 346  :         if ((c = getbyte(*(s->c))) < 0)
; 347  :             break;
; 348  :         s_b(s)[s->ip] = LZO_BYTE(c);
; 349  :         s->ip++;
; 350  :         s->look++;
; 351  :     }
; 352  : #endif
; 353  :     if (s->ip == s->b_size)

	mov	rcx, QWORD PTR [rsi+672]
	cmp	rcx, QWORD PTR [rsi+696]
	cmove	rcx, rbp

; 354  :         s->ip = 0;
; 355  : 
; 356  :     if (s->look >= 2 && s->dict_len > 0)

	cmp	QWORD PTR [rsi+72], 2
	mov	QWORD PTR [rsi+672], rcx
	jb	SHORT $LN3@swd_init
	mov	rdx, QWORD PTR [rsi+664]
	test	rdx, rdx
	je	SHORT $LN3@swd_init

; 357  :         swd_insertdict(s,0,s->dict_len);

	mov	rcx, rsi
	call	?swd_insertdict@@YAXPEAUlzo1x_999_swd_t@@_K1@Z ; swd_insertdict
$LN3@swd_init:

; 358  : 
; 359  :     s->rp = s->first_rp;

	mov	rax, QWORD PTR [rsi+720]

; 360  :     if (s->rp >= s->node_count)

	mov	rcx, QWORD PTR [rsi+712]
	mov	QWORD PTR [rsi+688], rax
	cmp	rax, rcx
	jb	SHORT $LN2@swd_init

; 361  :         s->rp -= s->node_count;

	sub	rax, rcx

; 362  :     else

	jmp	SHORT $LN9@swd_init
$LN2@swd_init:

; 363  :         s->rp += s->b_size - s->node_count;

	sub	rax, rcx
	add	rax, QWORD PTR [rsi+696]
$LN9@swd_init:

; 364  : 
; 365  : #if defined(__LZO_CHECKER)
; 366  :     /* initialize memory for the first few HEAD3 (if s->ip is not far
; 367  :      * enough ahead to do this job for us). The value doesn't matter. */
; 368  :     if (s->look < 3)
; 369  :         lzo_memset(&s_b(s)[s->bp+s->look],0,3);
; 370  : #endif
; 371  : 
; 372  :     LZO_UNUSED(i);
; 373  :     LZO_UNUSED(c);
; 374  :     return LZO_E_OK;
; 375  : }

	mov	rbx, QWORD PTR [rsp+48]
	mov	rbp, QWORD PTR [rsp+56]
	mov	QWORD PTR [rsi+688], rax
	mov	rsi, QWORD PTR [rsp+64]
	xor	eax, eax
	add	rsp, 32					; 00000020H
	pop	rdi
	ret	0
?swd_init@@YAHPEAUlzo1x_999_swd_t@@PEBE_K@Z ENDP	; swd_init
pdata	SEGMENT
$pdata$?find_match@@YAHPEAUlzo1x_999_t@@PEAUlzo1x_999_swd_t@@_K2@Z DD imagerel ?find_match@@YAHPEAUlzo1x_999_t@@PEAUlzo1x_999_swd_t@@_K2@Z
	DD	imagerel ?find_match@@YAHPEAUlzo1x_999_t@@PEAUlzo1x_999_swd_t@@_K2@Z+241
	DD	imagerel $unwind$?find_match@@YAHPEAUlzo1x_999_t@@PEAUlzo1x_999_swd_t@@_K2@Z
pdata	ENDS
xdata	SEGMENT
$unwind$?find_match@@YAHPEAUlzo1x_999_t@@PEAUlzo1x_999_swd_t@@_K2@Z DD 081401H
	DD	086414H
	DD	075414H
	DD	063414H
	DD	070103214H
; Function compile flags: /Ogtpy
; File c:\users\nummer\documents\github\olr-3.0\src\xray\xrcore\rt_lzo_mchw.ch
xdata	ENDS
_TEXT	SEGMENT
c$ = 48
s$ = 56
this_len$ = 64
skip$ = 72
?find_match@@YAHPEAUlzo1x_999_t@@PEAUlzo1x_999_swd_t@@_K2@Z PROC ; find_match

; 162  : {

	mov	QWORD PTR [rsp+8], rbx
	mov	QWORD PTR [rsp+16], rbp
	mov	QWORD PTR [rsp+24], rsi
	push	rdi
	sub	rsp, 32					; 00000020H
	mov	rbp, r9
	mov	rsi, r8
	mov	rdi, rdx
	mov	rbx, rcx

; 163  :     assert(c->init);
; 164  : 
; 165  :     if (skip > 0)

	test	r9, r9
	je	SHORT $LN6@find_match

; 166  :     {
; 167  :         assert(this_len >= skip);
; 168  :         swd_accept(s, this_len - skip);

	mov	rdx, r8
	mov	rcx, rdi
	sub	rdx, r9
	call	?swd_accept@@YAXPEAUlzo1x_999_swd_t@@_K@Z ; swd_accept

; 169  :         c->textsize += this_len - skip + 1;

	sub	rsi, rbp
	inc	rsi
	add	QWORD PTR [rbx+96], rsi

; 170  :     }
; 171  :     else

	jmp	SHORT $LN5@find_match
$LN6@find_match:

; 172  :     {
; 173  :         assert(this_len <= 1);
; 174  :         c->textsize += this_len - skip;

	sub	rsi, r9
	add	QWORD PTR [rcx+96], rsi
$LN5@find_match:

; 175  :     }
; 176  : 
; 177  :     s->m_len = 1;
; 178  :     s->m_len = THRESHOLD;
; 179  : #ifdef SWD_BEST_OFF
; 180  :     if (s->use_best_off)

	cmp	DWORD PTR [rdi+40], 0
	mov	QWORD PTR [rdi+56], 1
	je	SHORT $LN4@find_match

; 181  :         lzo_memset(s->best_pos,0,sizeof(s->best_pos));

	lea	rcx, QWORD PTR [rdi+376]
	xor	edx, edx
	mov	r8d, 272				; 00000110H
	call	memset
$LN4@find_match:

; 182  : #endif
; 183  :     swd_findbest(s);

	mov	rcx, rdi
	call	?swd_findbest@@YAXPEAUlzo1x_999_swd_t@@@Z ; swd_findbest

; 184  :     c->m_len = s->m_len;

	mov	rax, QWORD PTR [rdi+56]

; 185  :     c->m_off = s->m_off;
; 186  : 
; 187  :     swd_getbyte(s);

	mov	rcx, rdi
	mov	QWORD PTR [rbx+16], rax
	mov	rax, QWORD PTR [rdi+64]
	mov	QWORD PTR [rbx+24], rax
	call	?swd_getbyte@@YAXPEAUlzo1x_999_swd_t@@@Z ; swd_getbyte

; 188  : 
; 189  :     if (s->b_char < 0)

	cmp	DWORD PTR [rdi+80], 0
	jge	SHORT $LN3@find_match

; 190  :     {
; 191  :         c->look = 0;

	xor	eax, eax

; 192  :         c->m_len = 0;

	mov	QWORD PTR [rbx+16], rax

; 193  :         swd_exit(s);
; 194  :     }
; 195  :     else

	jmp	SHORT $LN14@find_match
$LN3@find_match:

; 196  :     {
; 197  :         c->look = s->look + 1;

	mov	rax, QWORD PTR [rdi+72]
	inc	rax
$LN14@find_match:

; 198  :     }
; 199  :     c->bp = c->ip - c->look;
; 200  : 
; 201  : #if 0
; 202  :     /* brute force match search */
; 203  :     if (c->m_len > THRESHOLD && c->m_len + 1 <= c->look)
; 204  :     {
; 205  :         const lzo_bytep ip = c->bp;
; 206  :         const lzo_bytep m  = c->bp - c->m_off;
; 207  :         const lzo_bytep in = c->in;
; 208  : 
; 209  :         if (ip - in > N)
; 210  :             in = ip - N;
; 211  :         for (;;)
; 212  :         {
; 213  :             while (*in != *ip)
; 214  :                 in++;
; 215  :             if (in == ip)
; 216  :                 break;
; 217  :             if (in != m)
; 218  :                 if (lzo_memcmp(in,ip,c->m_len+1) == 0)
; 219  :                     printf("%p %p %p %5d\n",in,ip,m,c->m_len);
; 220  :             in++;
; 221  :         }
; 222  :     }
; 223  : #endif
; 224  : 
; 225  :     if (c->cb && c->cb->nprogress && c->textsize > c->printcount)

	mov	rcx, QWORD PTR [rbx+88]
	mov	QWORD PTR [rbx+8], rax
	mov	rax, QWORD PTR [rbx+56]
	sub	rax, QWORD PTR [rbx+8]
	mov	QWORD PTR [rbx+48], rax
	test	rcx, rcx
	je	SHORT $LN11@find_match
	mov	rax, QWORD PTR [rcx+16]
	test	rax, rax
	je	SHORT $LN11@find_match
	mov	rdx, QWORD PTR [rbx+96]
	cmp	rdx, QWORD PTR [rbx+112]
	jbe	SHORT $LN11@find_match

; 226  :     {
; 227  :         (*c->cb->nprogress)(c->cb, c->textsize, c->codesize, 0);

	mov	r8, QWORD PTR [rbx+104]
	xor	r9d, r9d
	call	rax

; 228  :         c->printcount += 1024;

	add	QWORD PTR [rbx+112], 1024		; 00000400H
$LN11@find_match:

; 229  :     }
; 230  : 
; 231  :     return LZO_E_OK;
; 232  : }

	mov	rbx, QWORD PTR [rsp+48]
	mov	rbp, QWORD PTR [rsp+56]
	mov	rsi, QWORD PTR [rsp+64]
	xor	eax, eax
	add	rsp, 32					; 00000020H
	pop	rdi
	ret	0
?find_match@@YAHPEAUlzo1x_999_t@@PEAUlzo1x_999_swd_t@@_K2@Z ENDP ; find_match
_TEXT	ENDS
pdata	SEGMENT
$pdata$?init_match@@YAHPEAUlzo1x_999_t@@PEAUlzo1x_999_swd_t@@PEBE_KI@Z DD imagerel ?init_match@@YAHPEAUlzo1x_999_t@@PEAUlzo1x_999_swd_t@@PEBE_KI@Z
	DD	imagerel ?init_match@@YAHPEAUlzo1x_999_t@@PEAUlzo1x_999_swd_t@@PEBE_KI@Z+96
	DD	imagerel $unwind$?init_match@@YAHPEAUlzo1x_999_t@@PEAUlzo1x_999_swd_t@@PEBE_KI@Z
pdata	ENDS
xdata	SEGMENT
$unwind$?init_match@@YAHPEAUlzo1x_999_t@@PEAUlzo1x_999_swd_t@@PEBE_KI@Z DD 020601H
	DD	030023206H
; Function compile flags: /Ogtpy
xdata	ENDS
_TEXT	SEGMENT
c$ = 48
s$ = 56
dict$ = 64
dict_len$ = 72
flags$ = 80
?init_match@@YAHPEAUlzo1x_999_t@@PEAUlzo1x_999_swd_t@@PEBE_KI@Z PROC ; init_match

; 132  : {

	push	rbx
	sub	rsp, 32					; 00000020H
	mov	rbx, rdx

; 133  :     int r;
; 134  : 
; 135  :     assert(!c->init);
; 136  :     c->init = 1;

	mov	DWORD PTR [rcx], 1

; 137  : 
; 138  :     s->c = c;

	mov	QWORD PTR [rdx+360], rcx

; 139  : 
; 140  :     c->last_m_len = c->last_m_off = 0;

	xor	edx, edx
	mov	rax, r8

; 141  : 
; 142  :     c->textsize = c->codesize = c->printcount = 0;
; 143  :     c->lit_bytes = c->match_bytes = c->rep_bytes = 0;
; 144  :     c->lazy = 0;
; 145  : 
; 146  :     r = swd_init(s,dict,dict_len);

	mov	r8, r9
	mov	QWORD PTR [rcx+40], rdx
	mov	QWORD PTR [rcx+32], rdx
	mov	QWORD PTR [rcx+112], rdx
	mov	QWORD PTR [rcx+104], rdx
	mov	QWORD PTR [rcx+96], rdx
	mov	QWORD PTR [rcx+124], rdx
	mov	DWORD PTR [rcx+120], edx
	mov	DWORD PTR [rcx+132], edx
	mov	rdx, rax
	mov	rcx, rbx
	call	?swd_init@@YAHPEAUlzo1x_999_swd_t@@PEBE_K@Z ; swd_init

; 147  :     if (r != 0)

	test	eax, eax

; 148  :         return r;

	jne	SHORT $LN2@init_match

; 149  : 
; 150  :     s->use_best_off = (flags & 1) ? 1 : 0;

	mov	eax, DWORD PTR flags$[rsp]
	and	eax, 1
	mov	DWORD PTR [rbx+40], eax

; 151  :     return r;

	xor	eax, eax
$LN2@init_match:

; 152  : }

	add	rsp, 32					; 00000020H
	pop	rbx
	ret	0
?init_match@@YAHPEAUlzo1x_999_t@@PEAUlzo1x_999_swd_t@@PEBE_KI@Z ENDP ; init_match
PUBLIC	lzo1x_999_compress_internal
pdata	SEGMENT
$pdata$lzo1x_999_compress_internal DD imagerel $LN106
	DD	imagerel $LN106+345
	DD	imagerel $unwind$lzo1x_999_compress_internal
$pdata$0$lzo1x_999_compress_internal DD imagerel $LN106+345
	DD	imagerel $LN106+550
	DD	imagerel $chain$0$lzo1x_999_compress_internal
$pdata$1$lzo1x_999_compress_internal DD imagerel $LN106+550
	DD	imagerel $LN106+651
	DD	imagerel $chain$1$lzo1x_999_compress_internal
$pdata$2$lzo1x_999_compress_internal DD imagerel $LN106+651
	DD	imagerel $LN106+1552
	DD	imagerel $chain$2$lzo1x_999_compress_internal
pdata	ENDS
xdata	SEGMENT
$unwind$lzo1x_999_compress_internal DD 092001H
	DD	01e0120H
	DD	0e012f014H
	DD	0700ed010H
	DD	0300c600dH
	DD	0500bH
$chain$0$lzo1x_999_compress_internal DD 020821H
	DD	01dc408H
	DD	imagerel $LN106
	DD	imagerel $LN106+345
	DD	imagerel $unwind$lzo1x_999_compress_internal
$chain$1$lzo1x_999_compress_internal DD 021H
	DD	imagerel $LN106
	DD	imagerel $LN106+345
	DD	imagerel $unwind$lzo1x_999_compress_internal
$chain$2$lzo1x_999_compress_internal DD 020021H
	DD	01dc400H
	DD	imagerel $LN106
	DD	imagerel $LN106+345
	DD	imagerel $unwind$lzo1x_999_compress_internal
; Function compile flags: /Ogtpy
; File c:\users\nummer\documents\github\olr-3.0\src\xray\xrcore\rt_lzo1x_9x.cpp
xdata	ENDS
_TEXT	SEGMENT
cc$ = 32
ii$1$ = 304
in$ = 304
m_off$1$ = 312
in_len$ = 312
out$ = 320
out_len$ = 328
l1$1$ = 336
wrkmem$ = 336
dict$ = 344
dict_len$ = 352
try_lazy$ = 360
good_length$ = 368
max_lazy$ = 376
max_chain$ = 384
flags$ = 392
lzo1x_999_compress_internal PROC

; 543  : {

$LN106:
	mov	QWORD PTR [rsp+32], r9
	mov	QWORD PTR [rsp+24], r8
	push	rbp
	push	rbx
	push	rsi
	push	rdi
	push	r13
	push	r14
	push	r15
	lea	rbp, QWORD PTR [rsp-7]
	sub	rsp, 240				; 000000f0H

; 544  :     lzo_bytep op;
; 545  :     const lzo_bytep ii;
; 546  :     lzo_uint lit;
; 547  :     lzo_uint m_len, m_off;
; 548  :     LZO_COMPRESS_T cc;
; 549  :     LZO_COMPRESS_T * const c = &cc;
; 550  :     lzo_swd_p const swd = (lzo_swd_p) wrkmem;
; 551  :     int r;
; 552  : 
; 553  :     /* sanity check */
; 554  : #if defined(LZO1X)
; 555  :     LZO_COMPILE_TIME_ASSERT(LZO1X_999_MEM_COMPRESS >= SIZEOF_LZO_SWD_T)
; 556  : #elif defined(LZO1Y)
; 557  :     LZO_COMPILE_TIME_ASSERT(LZO1Y_999_MEM_COMPRESS >= SIZEOF_LZO_SWD_T)
; 558  : #elif defined(LZO1Z)
; 559  :     LZO_COMPILE_TIME_ASSERT(LZO1Z_999_MEM_COMPRESS >= SIZEOF_LZO_SWD_T)
; 560  : #else
; 561  : #  error
; 562  : #endif
; 563  : 
; 564  : /* setup parameter defaults */
; 565  :     /* number of lazy match tries */
; 566  :     if (try_lazy < 0)

	mov	eax, DWORD PTR try_lazy$[rbp-233]

; 567  :         try_lazy = 1;
; 568  :     /* reduce lazy match search if we already have a match with this length */
; 569  :     if (good_length <= 0)
; 570  :         good_length = 32;
; 571  :     /* do not try a lazy match if we already have a match with this length */
; 572  :     if (max_lazy <= 0)
; 573  :         max_lazy = 32;
; 574  :     /* stop searching for longer matches than this one */
; 575  :     if (nice_length <= 0)
; 576  :         nice_length = 0;
; 577  :     /* don't search more positions than this */
; 578  :     if (max_chain <= 0)

	mov	r15, QWORD PTR max_chain$[rbp-233]

; 579  :         max_chain = SWD_MAX_CHAIN;
; 580  : 
; 581  :     c->init = 0;
; 582  :     c->ip = c->in = in;
; 583  :     c->in_end = in + in_len;
; 584  :     c->out = out;
; 585  :     c->cb = cb;
; 586  :     c->m1a_m = c->m1b_m = c->m2_m = c->m3_m = c->m4_m = 0;
; 587  :     c->lit1_r = c->lit2_r = c->lit3_r = 0;
; 588  : 
; 589  :     op = out;
; 590  :     ii = c->ip;             /* point to start of literal run */
; 591  :     lit = 0;
; 592  :     c->r1_lit = c->r1_m_len = 0;
; 593  : 
; 594  :     r = init_match(c,swd,dict,dict_len,flags);

	mov	rbx, QWORD PTR wrkmem$[rbp-233]
	test	eax, eax
	mov	rdi, rcx
	mov	rsi, r8
	mov	r8d, 1
	mov	QWORD PTR ii$1$[rbp-233], rcx
	mov	ecx, 32					; 00000020H
	cmovs	eax, r8d
	mov	DWORD PTR cc$[rsp], r8d
	mov	r8, QWORD PTR dict_len$[rbp-233]
	mov	DWORD PTR try_lazy$[rbp-233], eax
	mov	rax, QWORD PTR good_length$[rbp-233]
	mov	QWORD PTR cc$[rsp+64], rdi
	test	rax, rax
	mov	QWORD PTR cc$[rsp+56], rdi
	mov	QWORD PTR cc$[rbp-153], rsi
	cmove	rax, rcx
	mov	r14, rsi
	mov	QWORD PTR good_length$[rbp-233], rax
	mov	rax, QWORD PTR max_lazy$[rbp-233]
	test	rax, rax
	cmove	rax, rcx
	test	r15, r15
	mov	rcx, rbx
	mov	QWORD PTR max_lazy$[rbp-233], rax
	mov	eax, 2048				; 00000800H
	cmove	r15, rax
	xor	r9d, r9d
	lea	rax, QWORD PTR [rdi+rdx]
	mov	rdx, QWORD PTR dict$[rbp-233]
	mov	QWORD PTR cc$[rsp+72], rax
	lea	rax, QWORD PTR cc$[rsp]
	mov	QWORD PTR [rbx+360], rax
	mov	QWORD PTR max_chain$[rbp-233], r15
	mov	QWORD PTR cc$[rbp-145], r9
	mov	QWORD PTR cc$[rbp-69], r9
	mov	QWORD PTR cc$[rbp-77], r9
	mov	DWORD PTR cc$[rbp-81], r9d
	mov	QWORD PTR cc$[rbp-57], r9
	mov	DWORD PTR cc$[rbp-61], r9d
	mov	r13d, r9d
	mov	QWORD PTR cc$[rbp-89], r9
	mov	QWORD PTR cc$[rbp-97], r9
	mov	QWORD PTR cc$[rsp+40], r9
	mov	QWORD PTR cc$[rsp+32], r9
	mov	QWORD PTR cc$[rbp-121], r9
	mov	QWORD PTR cc$[rbp-129], r9
	mov	QWORD PTR cc$[rbp-137], r9
	mov	QWORD PTR cc$[rbp-109], r9
	mov	DWORD PTR cc$[rbp-113], r9d
	mov	DWORD PTR cc$[rbp-101], r9d
	call	?swd_init@@YAHPEAUlzo1x_999_swd_t@@PEBE_K@Z ; swd_init
	test	eax, eax
	jne	$LN46@lzo1x_999_
	mov	eax, DWORD PTR flags$[rbp-233]
	and	eax, 1
	mov	DWORD PTR [rbx+40], eax

; 595  :     if (r != 0)
; 596  :         return r;
; 597  :     if (max_chain > 0)

	test	r15, r15
	je	SHORT $LN31@lzo1x_999_

; 598  :         swd->max_chain = max_chain;

	mov	QWORD PTR [rbx+24], r15
$LN31@lzo1x_999_:

; 599  :     if (nice_length > 0)
; 600  :         swd->nice_length = nice_length;
; 601  : 
; 602  :     r = find_match(c,swd,0,0);

	lea	rcx, QWORD PTR cc$[rsp]
	xor	r9d, r9d
	xor	r8d, r8d
	mov	rdx, rbx
	call	?find_match@@YAHPEAUlzo1x_999_t@@PEAUlzo1x_999_swd_t@@_K2@Z ; find_match

; 603  :     if (r != 0)

	test	eax, eax

; 604  :         return r;

	jne	$LN46@lzo1x_999_

; 605  :     while (c->look > 0)

	cmp	QWORD PTR cc$[rsp+8], r13
	jbe	$LN2@lzo1x_999_
	mov	r11, QWORD PTR cc$[rsp+24]
	mov	r9, QWORD PTR cc$[rsp+16]
	mov	QWORD PTR [rsp+232], r12
	npad	15
$LL29@lzo1x_999_:

; 606  :     {
; 607  :         lzo_uint ahead;
; 608  :         lzo_uint max_ahead;
; 609  :         int l1, l2, l3;
; 610  : 
; 611  :         c->codesize = pd(op, out);
; 612  : 
; 613  :         m_len = c->m_len;
; 614  :         m_off = c->m_off;
; 615  : 
; 616  :         assert(c->bp == c->ip - c->look);
; 617  :         assert(c->bp >= in);
; 618  :         if (lit == 0)

	mov	rcx, QWORD PTR ii$1$[rbp-233]
	mov	rax, r14
	mov	r12, r9
	sub	rax, rsi
	test	r13, r13
	mov	rdi, r11
	cmove	rcx, QWORD PTR cc$[rsp+48]
	mov	QWORD PTR cc$[rbp-129], rax
	mov	QWORD PTR m_off$1$[rbp-233], r11
	mov	QWORD PTR ii$1$[rbp-233], rcx

; 619  :             ii = c->bp;
; 620  :         assert(ii + lit == c->bp);
; 621  :         assert(swd->b_char == *(c->bp));
; 622  : 
; 623  :         if ( m_len < 2 ||
; 624  :             (m_len == 2 && (m_off > M1_MAX_OFFSET || lit == 0 || lit >= 4)) ||
; 625  : #if 1
; 626  :             /* Do not accept this match for compressed-data compatibility
; 627  :              * with LZO v1.01 and before
; 628  :              * [ might be a problem for decompress() and optimize() ]
; 629  :              */
; 630  :             (m_len == 2 && op == out) ||
; 631  : #endif
; 632  :             (op == out && lit == 0))

	cmp	r9, 2
	jb	SHORT $LN89@lzo1x_999_
	jne	SHORT $LN23@lzo1x_999_
	cmp	r11, 1024				; 00000400H
	ja	SHORT $LN89@lzo1x_999_
	test	r13, r13
	je	SHORT $LN89@lzo1x_999_
	cmp	r13, 4
	jae	SHORT $LN89@lzo1x_999_
	cmp	r14, rsi
	jmp	$LN100@lzo1x_999_
$LN23@lzo1x_999_:
	cmp	r14, rsi
	jne	SHORT $LN26@lzo1x_999_
	test	r13, r13
	je	SHORT $LN89@lzo1x_999_
$LN26@lzo1x_999_:

; 633  :         {
; 634  :             /* a literal */
; 635  :             m_len = 0;
; 636  :         }
; 637  :         else if (m_len == M2_MIN_LEN)

	cmp	r9, 3
	jne	$LN20@lzo1x_999_

; 638  :         {
; 639  :             /* compression ratio improves if we code a literal in some cases */
; 640  :             if (m_off > MX_MAX_OFFSET && lit >= 4)

	cmp	r11, 3072				; 00000c00H
	jbe	$LN19@lzo1x_999_
	cmp	r13, 4
	jb	$LN19@lzo1x_999_
$LN89@lzo1x_999_:

; 645  :         {
; 646  :     /* a literal */
; 647  :             lit++;
; 648  :             swd->max_chain = max_chain;
; 649  :             r = find_match(c,swd,1,0);

	xor	r9d, r9d
	lea	rcx, QWORD PTR cc$[rsp]
	mov	rdx, rbx
	lea	r8d, QWORD PTR [r9+1]
	inc	r13
	mov	QWORD PTR [rbx+24], r15
	call	?find_match@@YAHPEAUlzo1x_999_t@@PEAUlzo1x_999_swd_t@@_K2@Z ; find_match
$LN104@lzo1x_999_:
	mov	rdi, QWORD PTR ii$1$[rbp-233]
$LN103@lzo1x_999_:

; 650  :             assert(r == 0);
; 651  :             continue;

	mov	r11, QWORD PTR cc$[rsp+24]
	mov	r9, QWORD PTR cc$[rsp+16]
$lazy_match_done$97688:

; 605  :     while (c->look > 0)

	cmp	QWORD PTR cc$[rsp+8], 0
	ja	$LL29@lzo1x_999_

; 764  :         assert(r == 0);
; 765  : 
; 766  : lazy_match_done: ;
; 767  :     }
; 768  : 
; 769  : 
; 770  :     /* store final run */
; 771  :     if (lit > 0)

	mov	r12, QWORD PTR [rsp+232]
	test	r13, r13
	je	SHORT $LN2@lzo1x_999_

; 772  :         op = STORE_RUN(c,op,ii,lit);

	lea	rcx, QWORD PTR cc$[rsp]
	mov	r9, r13
	mov	r8, rdi
	mov	rdx, r14
	call	?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z ; STORE_RUN
	mov	r14, rax
$LN2@lzo1x_999_:

; 773  : 
; 774  : #if defined(LZO_EOF_CODE)
; 775  :     *op++ = M4_MARKER | 1;
; 776  :     *op++ = 0;
; 777  :     *op++ = 0;
; 778  : #endif
; 779  : 
; 780  :     c->codesize = pd(op, out);
; 781  :     assert(c->textsize == in_len);
; 782  : 
; 783  :     *out_len = pd(op, out);

	mov	rax, QWORD PTR out_len$[rbp-233]
	mov	WORD PTR [r14], 17
	mov	BYTE PTR [r14+2], 0

; 784  : 
; 785  :     if (c->cb && c->cb->nprogress)

	mov	rcx, QWORD PTR cc$[rbp-145]
	add	r14, 3
	sub	r14, rsi
	mov	QWORD PTR cc$[rbp-129], r14
	mov	QWORD PTR [rax], r14
	test	rcx, rcx
	je	SHORT $LN1@lzo1x_999_
	mov	rax, QWORD PTR [rcx+16]
	test	rax, rax
	je	SHORT $LN1@lzo1x_999_

; 786  :         (*c->cb->nprogress)(c->cb, c->textsize, c->codesize, 0);

	mov	rdx, QWORD PTR cc$[rbp-137]
	xor	r9d, r9d
	mov	r8, r14
	call	rax
$LN1@lzo1x_999_:

; 787  : 
; 788  : #if 0
; 789  :     printf("%ld %ld -> %ld  %ld: %ld %ld %ld %ld %ld  %ld: %ld %ld %ld  %ld\n",
; 790  :         (long) c->textsize, (long) in_len, (long) c->codesize,
; 791  :         c->match_bytes, c->m1a_m, c->m1b_m, c->m2_m, c->m3_m, c->m4_m,
; 792  :         c->lit_bytes, c->lit1_r, c->lit2_r, c->lit3_r, c->lazy);
; 793  : #endif
; 794  :     assert(c->lit_bytes + c->match_bytes == in_len);
; 795  : 
; 796  :     return LZO_E_OK;

	xor	eax, eax

; 579  :         max_chain = SWD_MAX_CHAIN;
; 580  : 
; 581  :     c->init = 0;
; 582  :     c->ip = c->in = in;
; 583  :     c->in_end = in + in_len;
; 584  :     c->out = out;
; 585  :     c->cb = cb;
; 586  :     c->m1a_m = c->m1b_m = c->m2_m = c->m3_m = c->m4_m = 0;
; 587  :     c->lit1_r = c->lit2_r = c->lit3_r = 0;
; 588  : 
; 589  :     op = out;
; 590  :     ii = c->ip;             /* point to start of literal run */
; 591  :     lit = 0;
; 592  :     c->r1_lit = c->r1_m_len = 0;
; 593  : 
; 594  :     r = init_match(c,swd,dict,dict_len,flags);

$LN46@lzo1x_999_:

; 797  : }

	add	rsp, 240				; 000000f0H
	pop	r15
	pop	r14
	pop	r13
	pop	rdi
	pop	rsi
	pop	rbx
	pop	rbp
	ret	0
$LN20@lzo1x_999_:

; 641  :                 m_len = 0;
; 642  :         }
; 643  : 
; 644  :         if (m_len == 0)

	test	r9, r9
$LN100@lzo1x_999_:
	je	$LN89@lzo1x_999_
$LN19@lzo1x_999_:

; 652  :         }
; 653  : 
; 654  :     /* a match */
; 655  : #if defined(SWD_BEST_OFF)
; 656  :         if (swd->use_best_off)

	cmp	DWORD PTR [rbx+40], 0
	je	SHORT $LN48@lzo1x_999_

; 657  :             better_match(swd,&m_len,&m_off);

	cmp	r9, 3
	jbe	SHORT $LN48@lzo1x_999_
	mov	edx, 2048				; 00000800H
	cmp	r11, rdx
	jbe	SHORT $LN48@lzo1x_999_
	lea	rax, QWORD PTR [r9-4]
	cmp	rax, 5
	ja	SHORT $LN50@lzo1x_999_
	mov	rax, QWORD PTR [rbx+r9*8+80]
	test	rax, rax
	je	SHORT $LN50@lzo1x_999_
	cmp	rax, rdx
	jbe	SHORT $LN101@lzo1x_999_
$LN50@lzo1x_999_:
	cmp	r11, 16384				; 00004000H
	jbe	SHORT $LN48@lzo1x_999_
	lea	rax, QWORD PTR [r9-10]
	test	rax, rax
	jne	SHORT $LN49@lzo1x_999_
	mov	rax, QWORD PTR [rbx+r9*8+72]
	test	rax, rax
	je	SHORT $LN49@lzo1x_999_
	cmp	rax, rdx
	ja	SHORT $LN49@lzo1x_999_
	lea	r12, QWORD PTR [r9-2]
	jmp	SHORT $LN102@lzo1x_999_
$LN49@lzo1x_999_:
	lea	rax, QWORD PTR [r9-10]
	cmp	rax, 24
	ja	SHORT $LN48@lzo1x_999_
	mov	rax, QWORD PTR [rbx+r9*8+80]
	test	rax, rax
	je	SHORT $LN48@lzo1x_999_
	cmp	rax, 16384				; 00004000H
	ja	SHORT $LN48@lzo1x_999_
$LN101@lzo1x_999_:
	lea	r12, QWORD PTR [r9-1]
$LN102@lzo1x_999_:
	mov	rdi, QWORD PTR [rbx+r12*8+88]
	mov	QWORD PTR m_off$1$[rbp-233], rdi
$LN48@lzo1x_999_:

; 658  : #endif
; 659  :         assert_match(swd,m_len,m_off);
; 660  : 
; 661  : 
; 662  : 
; 663  :         /* shall we try a lazy match ? */
; 664  :         ahead = 0;
; 665  :         if (try_lazy <= 0 || m_len >= max_lazy)

	mov	r9d, DWORD PTR try_lazy$[rbp-233]
	xor	r8d, r8d
	mov	esi, r8d
	test	r9d, r9d
	jle	$LN91@lzo1x_999_
	cmp	r12, QWORD PTR max_lazy$[rbp-233]
	jae	$LN91@lzo1x_999_

; 666  :         {
; 667  :             /* no */
; 668  :             l1 = 0;
; 669  :             max_ahead = 0;
; 670  :         }
; 671  :         else
; 672  :         {
; 673  :             /* yes, try a lazy match */
; 674  :             l1 = len_of_coded_match(m_len,m_off,lit);

	mov	r8, r13
	mov	rdx, rdi
	mov	rcx, r12
	call	?len_of_coded_match@@YAH_K00@Z		; len_of_coded_match
	mov	DWORD PTR l1$1$[rbp-233], eax

; 675  :             assert(l1 > 0);
; 676  : #if 1
; 677  :             max_ahead = LZO_MIN(try_lazy, l1 - 1);

	lea	ecx, DWORD PTR [rax-1]
	cmp	r9d, ecx
	cmovle	ecx, r9d
	movsxd	r15, ecx

; 678  : #else
; 679  :             max_ahead = LZO_MIN3(try_lazy, l1, m_len - 1);
; 680  : #endif
; 681  :         }
; 682  : 
; 683  : 
; 684  :         while (ahead < max_ahead && c->look > m_len)

	test	ecx, ecx
	je	$LN95@lzo1x_999_
	npad	7
$LL14@lzo1x_999_:
	cmp	QWORD PTR cc$[rsp+8], r12
	jbe	$LN95@lzo1x_999_

; 685  :         {
; 686  :             lzo_int lazy_match_min_gain;
; 687  : 
; 688  :             if (m_len >= good_length)
; 689  :                 swd->max_chain = max_chain >> 2;

	mov	rax, QWORD PTR max_chain$[rbp-233]
	cmp	r12, QWORD PTR good_length$[rbp-233]
	jb	SHORT $LN12@lzo1x_999_
	shr	rax, 2
$LN12@lzo1x_999_:

; 690  :             else
; 691  :                 swd->max_chain = max_chain;
; 692  :             r = find_match(c,swd,1,0);

	inc	QWORD PTR cc$[rbp-137]
	cmp	DWORD PTR [rbx+40], 0
	mov	QWORD PTR [rbx+24], rax
	mov	QWORD PTR [rbx+56], 1
	je	SHORT $LN58@lzo1x_999_
	lea	rcx, QWORD PTR [rbx+376]
	xor	edx, edx
	mov	r8d, 272				; 00000110H
	call	memset
$LN58@lzo1x_999_:
	mov	rcx, rbx
	call	?swd_findbest@@YAXPEAUlzo1x_999_swd_t@@@Z ; swd_findbest
	mov	r11, QWORD PTR [rbx+56]
	mov	rax, QWORD PTR [rbx+64]
	mov	rcx, rbx
	mov	QWORD PTR cc$[rsp+16], r11
	mov	QWORD PTR cc$[rsp+24], rax
	call	?swd_getbyte@@YAXPEAUlzo1x_999_swd_t@@@Z ; swd_getbyte
	cmp	DWORD PTR [rbx+80], 0
	jge	SHORT $LN57@lzo1x_999_
	xor	r9d, r9d
	mov	QWORD PTR cc$[rsp+8], r9
	mov	QWORD PTR cc$[rsp+16], r9
	jmp	SHORT $LN56@lzo1x_999_
$LN57@lzo1x_999_:
	mov	rax, QWORD PTR [rbx+72]
	mov	r9, QWORD PTR cc$[rsp+16]
	inc	rax
	mov	QWORD PTR cc$[rsp+8], rax
$LN56@lzo1x_999_:
	mov	rax, QWORD PTR cc$[rsp+56]
	mov	rcx, QWORD PTR cc$[rbp-145]
	sub	rax, QWORD PTR cc$[rsp+8]
	mov	QWORD PTR cc$[rsp+48], rax
	test	rcx, rcx
	je	SHORT $LN90@lzo1x_999_
	mov	rax, QWORD PTR [rcx+16]
	test	rax, rax
	je	SHORT $LN90@lzo1x_999_
	mov	rdx, QWORD PTR cc$[rbp-137]
	cmp	rdx, QWORD PTR cc$[rbp-121]
	jbe	SHORT $LN90@lzo1x_999_
	mov	r8, QWORD PTR cc$[rbp-129]
	xor	r9d, r9d
	call	rax
	add	QWORD PTR cc$[rbp-121], 1024		; 00000400H
	mov	r9, QWORD PTR cc$[rsp+16]
$LN90@lzo1x_999_:

; 693  :             ahead++;

	inc	rsi

; 694  : 
; 695  :             assert(r == 0);
; 696  :             assert(c->look > 0);
; 697  :             assert(ii + lit + ahead == c->bp);
; 698  : 
; 699  : #if defined(LZO1Z)
; 700  :             if (m_off == c->last_m_off && c->m_off != c->last_m_off)
; 701  :                 if (m_len >= M2_MIN_LEN && m_len <= M2_MAX_LEN)
; 702  :                     c->m_len = 0;
; 703  : #endif
; 704  :             if (c->m_len < m_len)

	cmp	r9, r12
	jb	$LN98@lzo1x_999_

; 705  :                 continue;
; 706  : #if 1
; 707  :             if (c->m_len == m_len && c->m_off >= m_off)

	mov	r11, QWORD PTR cc$[rsp+24]
	jne	SHORT $LN9@lzo1x_999_
	cmp	r11, rdi
	jae	$LN98@lzo1x_999_
$LN9@lzo1x_999_:

; 708  :                 continue;
; 709  : #endif
; 710  : #if defined(SWD_BEST_OFF)
; 711  :             if (swd->use_best_off)

	cmp	DWORD PTR [rbx+40], 0
	je	SHORT $LN8@lzo1x_999_

; 712  :                 better_match(swd,&c->m_len,&c->m_off);

	lea	r8, QWORD PTR cc$[rsp+24]
	lea	rdx, QWORD PTR cc$[rsp+16]
	mov	rcx, rbx
	call	?better_match@@YAXPEBUlzo1x_999_swd_t@@PEA_K1@Z ; better_match
	mov	r11, QWORD PTR cc$[rsp+24]
	mov	r9, QWORD PTR cc$[rsp+16]
$LN8@lzo1x_999_:

; 713  : #endif
; 714  :             l2 = len_of_coded_match(c->m_len,c->m_off,lit+ahead);

	lea	rdi, QWORD PTR [rsi+r13]
	mov	rdx, r11
	mov	rcx, r9
	mov	r8, rdi
	call	?len_of_coded_match@@YAH_K00@Z		; len_of_coded_match
	mov	r10d, eax

; 715  :             if (l2 < 0)

	test	eax, eax
	js	$LN92@lzo1x_999_

; 716  :                 continue;
; 717  : #if 0
; 718  :             if (c->m_len == m_len && l2 >= l1)
; 719  :                 continue;
; 720  : #endif
; 721  : 
; 722  : 
; 723  : #if 1
; 724  :             /* compressed-data compatibility [see above] */
; 725  :             l3 = (op == out) ? -1 : len_of_coded_match(ahead,m_off,lit);

	cmp	r14, QWORD PTR out$[rbp-233]
	jne	SHORT $LN43@lzo1x_999_
	or	edx, -1
	jmp	SHORT $LN44@lzo1x_999_
$LN43@lzo1x_999_:
	mov	rdx, QWORD PTR m_off$1$[rbp-233]
	mov	r8, r13
	mov	rcx, rsi
	call	?len_of_coded_match@@YAH_K00@Z		; len_of_coded_match
	mov	edx, eax
$LN44@lzo1x_999_:

; 726  : #else
; 727  :             l3 = len_of_coded_match(ahead,m_off,lit);
; 728  : #endif
; 729  : 
; 730  :             lazy_match_min_gain = min_gain(ahead,lit,lit+ahead,l1,l2,l3);

	mov	rcx, rsi
	cmp	r13, 3
	ja	SHORT $LN69@lzo1x_999_
	mov	ecx, 2
	cmp	rdi, 3
	mov	r8d, 0
	cmovbe	ecx, r8d
	jmp	SHORT $LN105@lzo1x_999_
$LN69@lzo1x_999_:
	xor	r8d, r8d
	cmp	r13, 18
	ja	SHORT $LN67@lzo1x_999_
	cmp	rdi, 18
	mov	ecx, r8d
	seta	cl
$LN105@lzo1x_999_:
	add	rcx, rsi
$LN67@lzo1x_999_:
	sub	r10d, DWORD PTR l1$1$[rbp-233]
	lea	eax, DWORD PTR [r10+r10]
	cdqe
	add	rcx, rax
	test	edx, edx
	jle	SHORT $LN66@lzo1x_999_
	movsxd	rax, edx
	sub	rax, rsi
	lea	rcx, QWORD PTR [rcx+rax*2]
$LN66@lzo1x_999_:
	test	rcx, rcx
	cmovs	rcx, r8

; 731  :             if (c->m_len >= m_len + lazy_match_min_gain)

	lea	rax, QWORD PTR [rcx+r12]
	cmp	r9, rax
	jae	SHORT $LN86@lzo1x_999_

; 657  :             better_match(swd,&m_len,&m_off);

	mov	rdi, QWORD PTR m_off$1$[rbp-233]
	jmp	SHORT $LN6@lzo1x_999_
$LN92@lzo1x_999_:
	mov	rdi, QWORD PTR m_off$1$[rbp-233]
$LN98@lzo1x_999_:

; 773  : 
; 774  : #if defined(LZO_EOF_CODE)
; 775  :     *op++ = M4_MARKER | 1;
; 776  :     *op++ = 0;
; 777  :     *op++ = 0;
; 778  : #endif
; 779  : 
; 780  :     c->codesize = pd(op, out);
; 781  :     assert(c->textsize == in_len);
; 782  : 
; 783  :     *out_len = pd(op, out);

	xor	r8d, r8d
$LN6@lzo1x_999_:

; 678  : #else
; 679  :             max_ahead = LZO_MIN3(try_lazy, l1, m_len - 1);
; 680  : #endif
; 681  :         }
; 682  : 
; 683  : 
; 684  :         while (ahead < max_ahead && c->look > m_len)

	cmp	rsi, r15
	jb	$LL14@lzo1x_999_
	jmp	SHORT $LN96@lzo1x_999_
$LN86@lzo1x_999_:

; 732  :             {
; 733  :                 c->lazy++;

	inc	DWORD PTR cc$[rbp-101]

; 734  :                 assert_match(swd,c->m_len,c->m_off);
; 735  : 
; 736  :                 if (l3 > 0)
; 737  :                 {
; 738  :                     /* code previous run */
; 739  :                     op = code_run(c,op,ii,lit,ahead);

	mov	rdi, QWORD PTR ii$1$[rbp-233]
	test	edx, edx
	jle	SHORT $LN5@lzo1x_999_
	test	r13, r13
	je	SHORT $LN73@lzo1x_999_
	lea	rcx, QWORD PTR cc$[rsp]
	mov	r9, r13
	mov	r8, rdi
	mov	rdx, r14
	call	?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z ; STORE_RUN
	mov	QWORD PTR cc$[rbp-89], rsi
	mov	QWORD PTR cc$[rbp-97], r13
	mov	r14, rax
	xor	r8d, r8d
	jmp	SHORT $LN72@lzo1x_999_
$LN73@lzo1x_999_:
	mov	QWORD PTR cc$[rbp-89], r8
	mov	QWORD PTR cc$[rbp-97], r8
$LN72@lzo1x_999_:

; 740  :                     lit = 0;
; 741  :                     /* code shortened match */
; 742  :                     op = code_match(c,op,ahead,m_off);

	mov	r9, QWORD PTR m_off$1$[rbp-233]
	mov	r13, r8
	lea	rcx, QWORD PTR cc$[rsp]
	mov	r8, rsi
	mov	rdx, r14
	call	?code_match@@YAPEAEPEAUlzo1x_999_t@@PEAE_K2@Z ; code_match

; 743  :                 }
; 744  :                 else

	mov	r15, QWORD PTR max_chain$[rbp-233]
	mov	rsi, QWORD PTR out$[rbp-233]
	mov	r14, rax
	jmp	$LN103@lzo1x_999_
$LN5@lzo1x_999_:

; 745  :                 {
; 746  :                     lit += ahead;
; 747  :                     assert(ii + lit == c->bp);
; 748  :                 }
; 749  :                 goto lazy_match_done;

	mov	r15, QWORD PTR max_chain$[rbp-233]
	add	r13, rsi
	mov	rsi, QWORD PTR out$[rbp-233]
	jmp	$lazy_match_done$97688
$LN95@lzo1x_999_:
	xor	r8d, r8d
$LN96@lzo1x_999_:
	mov	r15, QWORD PTR max_chain$[rbp-233]
	mov	rcx, QWORD PTR ii$1$[rbp-233]
$LN91@lzo1x_999_:

; 750  :             }
; 751  :         }
; 752  : 
; 753  : 
; 754  :         assert(ii + lit + ahead == c->bp);
; 755  : 
; 756  :         /* 1 - code run */
; 757  :         op = code_run(c,op,ii,lit,m_len);

	test	r13, r13
	je	SHORT $LN77@lzo1x_999_
	mov	r8, rcx
	lea	rcx, QWORD PTR cc$[rsp]
	mov	r9, r13
	mov	rdx, r14
	call	?STORE_RUN@@YAPEAEPEAUlzo1x_999_t@@PEAEPEBE_K@Z ; STORE_RUN
	mov	QWORD PTR cc$[rbp-89], r12
	mov	QWORD PTR cc$[rbp-97], r13
	mov	r14, rax
	xor	r8d, r8d
	jmp	SHORT $LN76@lzo1x_999_
$LN77@lzo1x_999_:
	mov	QWORD PTR cc$[rbp-89], r8
	mov	QWORD PTR cc$[rbp-97], r8
$LN76@lzo1x_999_:

; 758  :         lit = 0;

	mov	r13, r8

; 759  : 
; 760  :         /* 2 - code match */
; 761  :         op = code_match(c,op,m_len,m_off);

	lea	rcx, QWORD PTR cc$[rsp]
	mov	r9, rdi
	mov	r8, r12
	mov	rdx, r14
	call	?code_match@@YAPEAEPEAUlzo1x_999_t@@PEAE_K2@Z ; code_match

; 762  :         swd->max_chain = max_chain;
; 763  :         r = find_match(c,swd,m_len,1+ahead);

	lea	r9, QWORD PTR [rsi+1]
	lea	rcx, QWORD PTR cc$[rsp]
	mov	r8, r12
	mov	rdx, rbx
	mov	QWORD PTR [rbx+24], r15
	mov	r14, rax
	call	?find_match@@YAHPEAUlzo1x_999_t@@PEAUlzo1x_999_swd_t@@_K2@Z ; find_match
	mov	rsi, QWORD PTR out$[rbp-233]
	jmp	$LN104@lzo1x_999_
lzo1x_999_compress_internal ENDP
PUBLIC	lzo1x_999_compress_level
pdata	SEGMENT
$pdata$lzo1x_999_compress_level DD imagerel $LN6
	DD	imagerel $LN6+96
	DD	imagerel $unwind$lzo1x_999_compress_level
pdata	ENDS
xdata	SEGMENT
$unwind$lzo1x_999_compress_level DD 010401H
	DD	0c204H
; Function compile flags: /Ogtpy
xdata	ENDS
_TEXT	SEGMENT
in$ = 112
in_len$ = 120
out$ = 128
out_len$ = 136
wrkmem$ = 144
dict$ = 152
dict_len$ = 160
lzo1x_999_compress_level PROC

; 811  : {

$LN6:
	sub	rsp, 104				; 00000068H

; 812  :     static const struct
; 813  :     {
; 814  :         int try_lazy;
; 815  :         lzo_uint good_length;
; 816  :         lzo_uint max_lazy;
; 817  :         lzo_uint nice_length;
; 818  :         lzo_uint max_chain;
; 819  :         lzo_uint32 flags;
; 820  :     } c[9] = {
; 821  :         {   0,   0,   0,   8,    4,   0 },      /* faster compression */
; 822  :         {   0,   0,   0,  16,    8,   0 },
; 823  :         {   0,   0,   0,  32,   16,   0 },
; 824  : 
; 825  :         {   1,   4,   4,  16,   16,   0 },
; 826  :         {   1,   8,  16,  32,   32,   0 },
; 827  :         {   1,   8,  16, 128,  128,   0 },
; 828  : 
; 829  :         {   2,   8,  32, 128,  256,   0 },
; 830  :         {   2,  32, 128,   F, 2048,   1 },
; 831  :         {   2,   F,   F,   F, 4096,   1 }       /* max. compression */
; 832  :     };
; 833  : 
; 834  :     if (compression_level < 1 || compression_level > 9)
; 835  :         return LZO_E_ERROR;
; 836  : 
; 837  :     compression_level -= 1;
; 838  :     return lzo1x_999_compress_internal(in, in_len, out, out_len, wrkmem,
; 839  :                                        dict, dict_len, cb,
; 840  :                                        c[compression_level].try_lazy,
; 841  :                                        c[compression_level].good_length,
; 842  :                                        c[compression_level].max_lazy,
; 843  : #if 0
; 844  :                                        c[compression_level].nice_length,
; 845  : #else
; 846  :                                        0,
; 847  : #endif
; 848  :                                        c[compression_level].max_chain,
; 849  :                                        c[compression_level].flags);

	mov	rax, QWORD PTR dict_len$[rsp]
	mov	DWORD PTR [rsp+88], 1
	mov	QWORD PTR [rsp+80], 2048		; 00000800H
	mov	QWORD PTR [rsp+72], 128			; 00000080H
	mov	QWORD PTR [rsp+64], 32			; 00000020H
	mov	DWORD PTR [rsp+56], 2
	mov	QWORD PTR [rsp+48], rax
	mov	rax, QWORD PTR dict$[rsp]
	mov	QWORD PTR [rsp+40], rax
	mov	rax, QWORD PTR wrkmem$[rsp]
	mov	QWORD PTR [rsp+32], rax
	call	lzo1x_999_compress_internal

; 850  : }

	add	rsp, 104				; 00000068H
	ret	0
lzo1x_999_compress_level ENDP
PUBLIC	lzo1x_999_compress
pdata	SEGMENT
$pdata$lzo1x_999_compress DD imagerel $LN8
	DD	imagerel $LN8+82
	DD	imagerel $unwind$lzo1x_999_compress
pdata	ENDS
xdata	SEGMENT
$unwind$lzo1x_999_compress DD 010401H
	DD	0c204H
; Function compile flags: /Ogtpy
xdata	ENDS
_TEXT	SEGMENT
in$ = 112
in_len$ = 120
out$ = 128
out_len$ = 136
wrkmem$ = 144
lzo1x_999_compress PROC

; 871  : {

$LN8:
	sub	rsp, 104				; 00000068H

; 872  :     return lzo1x_999_compress_level(in, in_len, out, out_len, wrkmem,
; 873  :                                     NULL, 0, (lzo_callback_p) 0, 8);

	mov	DWORD PTR [rsp+88], 1
	mov	QWORD PTR [rsp+80], 2048		; 00000800H
	mov	QWORD PTR [rsp+72], 128			; 00000080H
	xor	eax, eax
	mov	QWORD PTR [rsp+64], 32			; 00000020H
	mov	DWORD PTR [rsp+56], 2
	mov	QWORD PTR [rsp+48], rax
	mov	QWORD PTR [rsp+40], rax
	mov	rax, QWORD PTR wrkmem$[rsp]
	mov	QWORD PTR [rsp+32], rax
	call	lzo1x_999_compress_internal

; 874  : }

	add	rsp, 104				; 00000068H
	ret	0
lzo1x_999_compress ENDP
_TEXT	ENDS
PUBLIC	lzo1x_999_compress_dict
pdata	SEGMENT
$pdata$lzo1x_999_compress_dict DD imagerel $LN8
	DD	imagerel $LN8+95
	DD	imagerel $unwind$lzo1x_999_compress_dict
pdata	ENDS
xdata	SEGMENT
$unwind$lzo1x_999_compress_dict DD 010401H
	DD	0c204H
; Function compile flags: /Ogtpy
xdata	ENDS
_TEXT	SEGMENT
in$ = 112
in_len$ = 120
out$ = 128
out_len$ = 136
wrkmem$ = 144
dict_len$ = 152
lzo1x_999_compress_dict PROC

; 862  : {

$LN8:
	sub	rsp, 104				; 00000068H

; 863  :     return lzo1x_999_compress_level(in, in_len, out, out_len, wrkmem,
; 864  :                                     dict, dict_len, 0, 8);

	mov	rax, QWORD PTR dict_len$[rsp]
	mov	DWORD PTR [rsp+88], 1
	mov	QWORD PTR [rsp+80], 2048		; 00000800H
	mov	QWORD PTR [rsp+72], 128			; 00000080H
	mov	QWORD PTR [rsp+64], 32			; 00000020H
	mov	DWORD PTR [rsp+56], 2
	mov	QWORD PTR [rsp+48], rax
	mov	rax, QWORD PTR _LZO_Dictionary
	mov	QWORD PTR [rsp+40], rax
	mov	rax, QWORD PTR wrkmem$[rsp]
	mov	QWORD PTR [rsp+32], rax
	call	lzo1x_999_compress_internal

; 865  : }

	add	rsp, 104				; 00000068H
	ret	0
lzo1x_999_compress_dict ENDP
END
