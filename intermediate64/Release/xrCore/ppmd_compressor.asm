; Listing generated by Microsoft (R) Optimizing Compiler Version 16.00.40219.01 

include listing.inc

INCLUDELIB OLDNAMES

PUBLIC	?rewind@stream@ppmd@compression@@QEAAXXZ	; compression::ppmd::stream::rewind
PUBLIC	??$xr_new@Vstream@ppmd@compression@@PEAEI@@YAPEAVstream@ppmd@compression@@AEBQEAEAEBI@Z ; xr_new<compression::ppmd::stream,unsigned char * __ptr64,unsigned int>
PUBLIC	??0stream@ppmd@compression@@QEAA@PEBXAEBI@Z	; compression::ppmd::stream::stream
PUBLIC	?tell@stream@ppmd@compression@@QEBAIXZ		; compression::ppmd::stream::tell
PUBLIC	??_C@_0N@OPMDLHAN@mp?2?$CBPPMd?4mdl?$AA@	; `string'
PUBLIC	??_C@_0O@MGNGOECP@$game_config$?$AA@		; `string'
PUBLIC	??_C@_0BA@MLBHOGFL@ppmd_initialize?$AA@		; `string'
PUBLIC	??_C@_0BE@JMEOGMEE@ppmd_compressor?4cpp?$AA@	; `string'
PUBLIC	??_C@_06CFOFDHM@reader?$AA@			; `string'
PPMd_Locked DD	01H DUP (?)
;	COMDAT ?initialized@?3??ppmd_initialize@@YAXXZ@4_NA
_BSS	SEGMENT
?initialized@?3??ppmd_initialize@@YAXXZ@4_NA DB 01H DUP (?) ; `ppmd_initialize'::`4'::initialized
_BSS	ENDS
;	COMDAT ?ignore_always@?L@??ppmd_initialize@@YAXXZ@4_NA
_BSS	SEGMENT
?ignore_always@?L@??ppmd_initialize@@YAXXZ@4_NA DB 01H DUP (?) ; `ppmd_initialize'::`11'::ignore_always
;	COMDAT ??_C@_06CFOFDHM@reader?$AA@
CONST	SEGMENT
??_C@_06CFOFDHM@reader?$AA@ DB 'reader', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_0BE@JMEOGMEE@ppmd_compressor?4cpp?$AA@
CONST	SEGMENT
??_C@_0BE@JMEOGMEE@ppmd_compressor?4cpp?$AA@ DB 'ppmd_compressor.cpp', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0BA@MLBHOGFL@ppmd_initialize?$AA@
CONST	SEGMENT
??_C@_0BA@MLBHOGFL@ppmd_initialize?$AA@ DB 'ppmd_initialize', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0O@MGNGOECP@$game_config$?$AA@
CONST	SEGMENT
??_C@_0O@MGNGOECP@$game_config$?$AA@ DB '$game_config$', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0N@OPMDLHAN@mp?2?$CBPPMd?4mdl?$AA@
CONST	SEGMENT
??_C@_0N@OPMDLHAN@mp?2?$CBPPMd?4mdl?$AA@ DB 'mp\!PPMd.mdl', 00H ; `string'
; Function compile flags: /Ogtpy
; File c:\users\nummer\documents\github\olr-3.0\src\xray\xrcore\ppmd_compressor.cpp
_TEXT	SEGMENT
?PPMd_Unlock@@YAXXZ PROC				; PPMd_Unlock

; 31   :     ::InterlockedExchange( &PPMd_Locked, 0 );

	xor	eax, eax
	xchg	DWORD PTR PPMd_Locked, eax

; 32   : }

	ret	0
?PPMd_Unlock@@YAXXZ ENDP				; PPMd_Unlock
_TEXT	ENDS
pdata	SEGMENT
$pdata$?PPMd_Lock@@YAXXZ DD imagerel ?PPMd_Lock@@YAXXZ
	DD	imagerel ?PPMd_Lock@@YAXXZ+50
	DD	imagerel $unwind$?PPMd_Lock@@YAXXZ
pdata	ENDS
xdata	SEGMENT
$unwind$?PPMd_Lock@@YAXXZ DD 010401H
	DD	04204H
; Function compile flags: /Ogtpy
xdata	ENDS
_TEXT	SEGMENT
?PPMd_Lock@@YAXXZ PROC					; PPMd_Lock

; 23   : {

	sub	rsp, 40					; 00000028H

; 24   :     while( ::InterlockedExchange( &PPMd_Locked, 1 ) )

	mov	eax, 1
	xchg	DWORD PTR PPMd_Locked, eax
	test	eax, eax
	je	SHORT $LN1@PPMd_Lock
$LL2@PPMd_Lock:

; 25   :         ::Sleep( 0 );

	xor	ecx, ecx
	call	QWORD PTR __imp_Sleep
	mov	r11d, 1
	xchg	DWORD PTR PPMd_Locked, r11d
	test	r11d, r11d
	jne	SHORT $LL2@PPMd_Lock
$LN1@PPMd_Lock:

; 26   : }

	add	rsp, 40					; 00000028H
	ret	0
?PPMd_Lock@@YAXXZ ENDP					; PPMd_Lock
_TEXT	ENDS
PUBLIC	PrintInfo
; Function compile flags: /Ogtpy
_TEXT	SEGMENT
PrintInfo PROC

; 15   : }

	ret	0
PrintInfo ENDP
; Function compile flags: /Ogtpy
; File c:\users\nummer\documents\github\olr-3.0\src\xray\xrcore\compression_ppmd_stream_inline.h
_TEXT	ENDS
;	COMDAT ?tell@stream@ppmd@compression@@QEBAIXZ
_TEXT	SEGMENT
this$ = 8
?tell@stream@ppmd@compression@@QEBAIXZ PROC		; compression::ppmd::stream::tell, COMDAT

; 41   : 	VERIFY			(m_pointer >= m_buffer);
; 42   : 	VERIFY2			(m_pointer <= (m_buffer + m_buffer_size),make_string("0x%08x <= 0x%08x + %d",m_pointer,m_buffer,m_buffer_size));
; 43   : 	return			(u32(m_pointer - m_buffer));

	mov	eax, DWORD PTR [rcx+16]
	sub	eax, DWORD PTR [rcx+8]

; 44   : }

	ret	0
?tell@stream@ppmd@compression@@QEBAIXZ ENDP		; compression::ppmd::stream::tell
; Function compile flags: /Ogtpy
_TEXT	ENDS
;	COMDAT ?rewind@stream@ppmd@compression@@QEAAXXZ
_TEXT	SEGMENT
?rewind@stream@ppmd@compression@@QEAAXXZ PROC		; compression::ppmd::stream::rewind, COMDAT

; 30   : {

	mov	rcx, QWORD PTR ?trained_model@@3PEAVstream@ppmd@compression@@EA ; trained_model

; 31   : 	m_pointer		= m_buffer;

	mov	rax, QWORD PTR [rcx+8]
	mov	QWORD PTR [rcx+16], rax

; 32   : }

	ret	0
?rewind@stream@ppmd@compression@@QEAAXXZ ENDP		; compression::ppmd::stream::rewind
; Function compile flags: /Ogtpy
_TEXT	ENDS
;	COMDAT ??0stream@ppmd@compression@@QEAA@PEBXAEBI@Z
_TEXT	SEGMENT
this$ = 8
buffer$ = 16
buffer_size$ = 24
??0stream@ppmd@compression@@QEAA@PEBXAEBI@Z PROC	; compression::ppmd::stream::stream, COMDAT

; 8    : 	m_buffer_size	= buffer_size;

	mov	eax, DWORD PTR [r8]

; 9    : 	m_buffer		= (u8*)buffer;

	mov	QWORD PTR [rcx+8], rdx

; 10   : 	m_pointer		= m_buffer;

	mov	QWORD PTR [rcx+16], rdx
	mov	DWORD PTR [rcx], eax

; 11   : }

	mov	rax, rcx
	ret	0
??0stream@ppmd@compression@@QEAA@PEBXAEBI@Z ENDP	; compression::ppmd::stream::stream
;	COMDAT pdata
pdata	SEGMENT
$pdata$??$xr_new@Vstream@ppmd@compression@@PEAEI@@YAPEAVstream@ppmd@compression@@AEBQEAEAEBI@Z DD imagerel $LN9
	DD	imagerel $LN9+75
	DD	imagerel $unwind$??$xr_new@Vstream@ppmd@compression@@PEAEI@@YAPEAVstream@ppmd@compression@@AEBQEAEAEBI@Z
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$??$xr_new@Vstream@ppmd@compression@@PEAEI@@YAPEAVstream@ppmd@compression@@AEBQEAEAEBI@Z DD 040a01H
	DD	06340aH
	DD	07006320aH
; Function compile flags: /Ogtpy
; File c:\users\nummer\documents\github\olr-3.0\src\xray\xrcore\xrmemory_subst_msvc.h
xdata	ENDS
;	COMDAT ??$xr_new@Vstream@ppmd@compression@@PEAEI@@YAPEAVstream@ppmd@compression@@AEBQEAEAEBI@Z
_TEXT	SEGMENT
p1$ = 48
p2$ = 56
??$xr_new@Vstream@ppmd@compression@@PEAEI@@YAPEAVstream@ppmd@compression@@AEBQEAEAEBI@Z PROC ; xr_new<compression::ppmd::stream,unsigned char * __ptr64,unsigned int>, COMDAT

; 79   : IC	T*		xr_new		(const P1& p1, const P2& p2) {

$LN9:
	mov	QWORD PTR [rsp+8], rbx
	push	rdi
	sub	rsp, 32					; 00000020H
	mov	rdi, rcx
	mov	rbx, rdx

; 80   : 	T* ptr	= (T*)Memory.mem_alloc(sizeof(T));

	lea	rcx, OFFSET FLAT:?Memory@@3VxrMemory@@A	; Memory
	mov	edx, 24
	call	?mem_alloc@xrMemory@@QEAAPEAX_K@Z	; xrMemory::mem_alloc

; 81   : 	return new (ptr) T(p1,p2);

	test	rax, rax
	je	SHORT $LN3@xr_new@17
	mov	rcx, QWORD PTR [rdi]
	mov	edx, DWORD PTR [rbx]
	mov	DWORD PTR [rax], edx
	mov	QWORD PTR [rax+8], rcx
	mov	QWORD PTR [rax+16], rcx

; 82   : }

	mov	rbx, QWORD PTR [rsp+48]
	add	rsp, 32					; 00000020H
	pop	rdi
	ret	0
$LN3@xr_new@17:
	mov	rbx, QWORD PTR [rsp+48]
	add	rsp, 32					; 00000020H
	pop	rdi
	ret	0
??$xr_new@Vstream@ppmd@compression@@PEAEI@@YAPEAVstream@ppmd@compression@@AEBQEAEAEBI@Z ENDP ; xr_new<compression::ppmd::stream,unsigned char * __ptr64,unsigned int>
PUBLIC	?ppmd_initialize@@YAXXZ				; ppmd_initialize
pdata	SEGMENT
$pdata$?ppmd_initialize@@YAXXZ DD imagerel $LN83
	DD	imagerel $LN83+112
	DD	imagerel $unwind$?ppmd_initialize@@YAXXZ
$pdata$3$?ppmd_initialize@@YAXXZ DD imagerel $LN83+112
	DD	imagerel $LN83+387
	DD	imagerel $chain$3$?ppmd_initialize@@YAXXZ
$pdata$4$?ppmd_initialize@@YAXXZ DD imagerel $LN83+387
	DD	imagerel $LN83+443
	DD	imagerel $chain$4$?ppmd_initialize@@YAXXZ
$pdata$5$?ppmd_initialize@@YAXXZ DD imagerel $LN83+443
	DD	imagerel $LN83+481
	DD	imagerel $chain$5$?ppmd_initialize@@YAXXZ
$pdata$6$?ppmd_initialize@@YAXXZ DD imagerel $LN83+481
	DD	imagerel $LN83+527
	DD	imagerel $chain$6$?ppmd_initialize@@YAXXZ
$pdata$7$?ppmd_initialize@@YAXXZ DD imagerel $LN83+527
	DD	imagerel $LN83+561
	DD	imagerel $chain$7$?ppmd_initialize@@YAXXZ
pdata	ENDS
xdata	SEGMENT
$unwind$?ppmd_initialize@@YAXXZ DD 020701H
	DD	04d0107H
$chain$3$?ppmd_initialize@@YAXXZ DD 082721H
	DD	0517427H
	DD	050641fH
	DD	04f5410H
	DD	04e3408H
	DD	imagerel $LN83
	DD	imagerel $LN83+112
	DD	imagerel $unwind$?ppmd_initialize@@YAXXZ
$chain$4$?ppmd_initialize@@YAXXZ DD 020821H
	DD	04cc408H
	DD	imagerel $LN83+112
	DD	imagerel $LN83+387
	DD	imagerel $chain$3$?ppmd_initialize@@YAXXZ
$chain$5$?ppmd_initialize@@YAXXZ DD 021H
	DD	imagerel $LN83+112
	DD	imagerel $LN83+387
	DD	imagerel $chain$3$?ppmd_initialize@@YAXXZ
$chain$6$?ppmd_initialize@@YAXXZ DD 040021H
	DD	0506400H
	DD	04f5400H
	DD	imagerel $LN83
	DD	imagerel $LN83+112
	DD	imagerel $unwind$?ppmd_initialize@@YAXXZ
$chain$7$?ppmd_initialize@@YAXXZ DD 021H
	DD	imagerel $LN83
	DD	imagerel $LN83+112
	DD	imagerel $unwind$?ppmd_initialize@@YAXXZ
; Function compile flags: /Ogtpy
; File c:\users\nummer\documents\github\olr-3.0\src\xray\xrcore\ppmd_compressor.cpp
xdata	ENDS
_TEXT	SEGMENT
file_name$ = 80
?ppmd_initialize@@YAXXZ PROC				; ppmd_initialize

; 36   : {

$LN83:
	sub	rsp, 616				; 00000268H

; 37   : 	if (trained_model)

	mov	rcx, QWORD PTR ?trained_model@@3PEAVstream@ppmd@compression@@EA ; trained_model
	test	rcx, rcx
	je	SHORT $LN11@ppmd_initi

; 38   : 		trained_model->rewind	();

	mov	rax, QWORD PTR [rcx+8]
	mov	QWORD PTR [rcx+16], rax
$LN11@ppmd_initi:

; 39   : 
; 40   : 	static bool	initialized	= false;
; 41   : 	if (initialized)

	cmp	BYTE PTR ?initialized@?3??ppmd_initialize@@YAXXZ@4_NA, 0
	jne	$LN9@ppmd_initi

; 42   : 		return;
; 43   : 
; 44   : 	string_path			file_name;
; 45   : 
; 46   : 	FS.update_path		(file_name,"$game_config$","mp\\!PPMd.mdl");

	mov	rcx, QWORD PTR ?xr_FS@@3PEAVCLocatorAPI@@EA ; xr_FS
	lea	rdx, OFFSET FLAT:??_C@_0O@MGNGOECP@$game_config$?$AA@
	call	?get_path@CLocatorAPI@@QEAAPEAVFS_Path@@PEBD@Z ; CLocatorAPI::get_path
	lea	r8, OFFSET FLAT:??_C@_0N@OPMDLHAN@mp?2?$CBPPMd?4mdl?$AA@
	lea	rdx, QWORD PTR file_name$[rsp]
	mov	rcx, rax
	call	?_update@FS_Path@@QEBAPEBDAEAY0CAI@DPEBD@Z ; FS_Path::_update

; 47   : 	if (FS.exist(file_name)) {

	mov	rcx, QWORD PTR ?xr_FS@@3PEAVCLocatorAPI@@EA ; xr_FS
	lea	rdx, QWORD PTR file_name$[rsp]
	call	?exist@CLocatorAPI@@QEAAPEBUfile@1@PEBD@Z ; CLocatorAPI::exist
	test	rax, rax
	je	$LN75@ppmd_initi

; 48   : 		IReader			*reader = FS.r_open(file_name);

	mov	rcx, QWORD PTR ?xr_FS@@3PEAVCLocatorAPI@@EA ; xr_FS
	mov	QWORD PTR [rsp+624], rbx
	mov	QWORD PTR [rsp+632], rbp
	lea	r8, QWORD PTR file_name$[rsp]
	xor	edx, edx
	mov	QWORD PTR [rsp+640], rsi
	mov	QWORD PTR [rsp+648], rdi
	call	??$r_open_impl@VIReader@@@CLocatorAPI@@AEAAPEAVIReader@@PEBD0@Z ; CLocatorAPI::r_open_impl<IReader>

; 49   : 		R_ASSERT		(reader);

	cmp	BYTE PTR ?ignore_always@?L@??ppmd_initialize@@YAXXZ@4_NA, 0
	mov	rdi, rax
	jne	SHORT $LN4@ppmd_initi
	test	rax, rax
	jne	SHORT $LN4@ppmd_initi
	lea	rax, OFFSET FLAT:?ignore_always@?L@??ppmd_initialize@@YAXXZ@4_NA
	lea	r8, OFFSET FLAT:??_C@_06CFOFDHM@reader?$AA@
	lea	rdx, OFFSET FLAT:??_C@_0BB@DBHFCHNO@assertion?5failed?$AA@
	mov	QWORD PTR [rsp+64], rax
	lea	rax, OFFSET FLAT:??_C@_0BA@MLBHOGFL@ppmd_initialize?$AA@
	lea	rcx, OFFSET FLAT:?Debug@@3VxrDebug@@A	; Debug
	mov	QWORD PTR [rsp+56], rax
	lea	rax, OFFSET FLAT:??_C@_0BE@JMEOGMEE@ppmd_compressor?4cpp?$AA@
	mov	DWORD PTR [rsp+48], 49			; 00000031H
	mov	QWORD PTR [rsp+40], rax
	xor	r9d, r9d
	mov	QWORD PTR [rsp+32], rdi
	call	?backend@xrDebug@@QEAAXPEBD0000H0AEA_N@Z ; xrDebug::backend
$LN4@ppmd_initi:

; 50   : 		u32				buffer_size = reader->length();

	movsxd	rbp, DWORD PTR [rdi+20]

; 51   : 		u8				*buffer = (u8*)xr_malloc(buffer_size);

	lea	rcx, OFFSET FLAT:?Memory@@3VxrMemory@@A	; Memory
	mov	edx, ebp
	call	?mem_alloc@xrMemory@@QEAAPEAX_K@Z	; xrMemory::mem_alloc

; 52   : 		reader->r		(buffer,buffer_size);

	movsxd	rdx, DWORD PTR [rdi+16]
	mov	r8, rbp
	add	rdx, QWORD PTR [rdi+8]
	mov	rcx, rax
	mov	rsi, rax
	call	memcpy
	add	DWORD PTR [rdi+16], ebp

; 53   : 		FS.r_close		(reader);

	mov	rcx, QWORD PTR ?xr_FS@@3PEAVCLocatorAPI@@EA ; xr_FS
	test	DWORD PTR [rcx+160], 512		; 00000200H
	je	SHORT $LN37@ppmd_initi
	mov	rcx, rdi
	call	??$_unregister_open_file@VIReader@@@@YAXPEAVIReader@@@Z ; _unregister_open_file<IReader>
$LN37@ppmd_initi:
	mov	rcx, rdi
	call	__RTCastToVoid
	mov	r8, QWORD PTR [rdi]
	xor	edx, edx
	mov	rcx, rdi
	mov	rbx, rax
	call	QWORD PTR [r8]
	inc	DWORD PTR ?Memory@@3VxrMemory@@A
	movzx	eax, BYTE PTR [rbx-1]
	lea	rdi, QWORD PTR [rbx-1]
	cmp	eax, 55					; 00000037H
	jne	SHORT $LN49@ppmd_initi
	test	rdi, rdi
	je	SHORT $LN70@ppmd_initi
	and	rdi, -8
	mov	rcx, QWORD PTR [rdi-8]
	call	QWORD PTR __imp_free
	jmp	SHORT $LN70@ppmd_initi
$LN49@ppmd_initi:
	lea	rbx, QWORD PTR [rax+rax*4]
	mov	QWORD PTR [rsp+608], r12
	lea	r12, OFFSET FLAT:?mem_pools@@3PAVMEMPOOL@@A ; mem_pools
	mov	rcx, QWORD PTR [r12+rbx*8]
	call	QWORD PTR __imp_EnterCriticalSection
	mov	rax, QWORD PTR [r12+rbx*8+32]
	mov	QWORD PTR [rdi], rax
	mov	rcx, QWORD PTR [r12+rbx*8]
	mov	QWORD PTR [r12+rbx*8+32], rdi
	call	QWORD PTR __imp_LeaveCriticalSection
	mov	r12, QWORD PTR [rsp+608]
$LN70@ppmd_initi:

; 54   : 		trained_model	= xr_new<stream>(buffer,buffer_size);

	lea	rcx, OFFSET FLAT:?Memory@@3VxrMemory@@A	; Memory
	mov	edx, 24
	call	?mem_alloc@xrMemory@@QEAAPEAX_K@Z	; xrMemory::mem_alloc
	mov	rdi, QWORD PTR [rsp+648]
	mov	rbx, QWORD PTR [rsp+624]
	test	rax, rax
	je	SHORT $LN74@ppmd_initi
	mov	DWORD PTR [rax], ebp
	mov	QWORD PTR [rax+8], rsi
	mov	QWORD PTR [rax+16], rsi
	mov	QWORD PTR ?trained_model@@3PEAVstream@ppmd@compression@@EA, rax ; trained_model
	jmp	SHORT $LN81@ppmd_initi
$LN74@ppmd_initi:
	mov	QWORD PTR ?trained_model@@3PEAVstream@ppmd@compression@@EA, 0 ; trained_model
$LN81@ppmd_initi:
	mov	rbp, QWORD PTR [rsp+632]
	mov	rsi, QWORD PTR [rsp+640]
$LN75@ppmd_initi:

; 55   : 	}
; 56   : 
; 57   : 	initialized		= true;

	mov	BYTE PTR ?initialized@?3??ppmd_initialize@@YAXXZ@4_NA, 1

; 58   : 	if (StartSubAllocator(suballocator_size))

	call	StartSubAllocator
	test	eax, eax
	jne	SHORT $LN9@ppmd_initi

; 59   : 		return;
; 60   : 	
; 61   : 	exit			(-1);

	or	ecx, -1
	call	QWORD PTR __imp_exit
	int	3
$LN9@ppmd_initi:

; 62   : }

	add	rsp, 616				; 00000268H
	ret	0
$LN82@ppmd_initi:
?ppmd_initialize@@YAXXZ ENDP				; ppmd_initialize
PUBLIC	?ppmd_decompress@@YAIPEAXAEBIPEBX1@Z		; ppmd_decompress
pdata	SEGMENT
$pdata$?ppmd_decompress@@YAIPEAXAEBIPEBX1@Z DD imagerel $LN23
	DD	imagerel $LN23+170
	DD	imagerel $unwind$?ppmd_decompress@@YAIPEAXAEBIPEBX1@Z
pdata	ENDS
xdata	SEGMENT
$unwind$?ppmd_decompress@@YAIPEAXAEBIPEBX1@Z DD 081401H
	DD	0e6414H
	DD	0d5414H
	DD	0c3414H
	DD	070109214H
; Function compile flags: /Ogtpy
xdata	ENDS
_TEXT	SEGMENT
dest$ = 32
source$ = 56
dest_buffer$ = 96
dest_buffer_size$ = 104
source_buffer$ = 112
source_buffer_size$ = 120
?ppmd_decompress@@YAIPEAXAEBIPEBX1@Z PROC		; ppmd_decompress

; 78   : {

$LN23:
	mov	QWORD PTR [rsp+8], rbx
	mov	QWORD PTR [rsp+16], rbp
	mov	QWORD PTR [rsp+24], rsi
	push	rdi
	sub	rsp, 80					; 00000050H

; 79   :     PPMd_Lock();

	mov	eax, 1
	mov	rsi, r9
	mov	rbx, r8
	xchg	DWORD PTR PPMd_Locked, eax
	mov	rbp, rdx
	mov	rdi, rcx
	test	eax, eax
	je	SHORT $LN3@ppmd_decom
	npad	1
$LL4@ppmd_decom:
	xor	ecx, ecx
	call	QWORD PTR __imp_Sleep
	mov	r11d, 1
	xchg	DWORD PTR PPMd_Locked, r11d
	test	r11d, r11d
	jne	SHORT $LL4@ppmd_decom
$LN3@ppmd_decom:

; 80   : 	ppmd_initialize	();

	call	?ppmd_initialize@@YAXXZ			; ppmd_initialize

; 81   : 
; 82   : 	stream			source(source_buffer,source_buffer_size);

	mov	r11d, DWORD PTR [rsi]

; 83   : 	stream			dest(dest_buffer,dest_buffer_size);

	mov	eax, DWORD PTR [rbp]

; 84   : 	DecodeFile		(&dest,&source,order_model,restoration_method_cut_off);

	lea	rdx, QWORD PTR source$[rsp]
	lea	rcx, QWORD PTR dest$[rsp]
	mov	DWORD PTR source$[rsp], r11d
	mov	DWORD PTR dest$[rsp], eax
	mov	QWORD PTR source$[rsp+8], rbx
	mov	QWORD PTR source$[rsp+16], rbx
	mov	QWORD PTR dest$[rsp+8], rdi
	mov	QWORD PTR dest$[rsp+16], rdi
	call	DecodeFile

; 85   : 
; 86   : 	PPMd_Unlock();
; 87   : 	return			(dest.tell());
; 88   : }

	mov	rbx, QWORD PTR [rsp+96]
	mov	rbp, QWORD PTR [rsp+104]
	mov	rsi, QWORD PTR [rsp+112]
	xor	r11d, r11d
	xchg	DWORD PTR PPMd_Locked, r11d
	mov	rax, QWORD PTR dest$[rsp+16]
	sub	rax, QWORD PTR dest$[rsp+8]
	add	rsp, 80					; 00000050H
	pop	rdi
	ret	0
?ppmd_decompress@@YAIPEAXAEBIPEBX1@Z ENDP		; ppmd_decompress
_TEXT	ENDS
PUBLIC	?ppmd_compress@@YAIPEAXAEBIPEBX1@Z		; ppmd_compress
pdata	SEGMENT
$pdata$?ppmd_compress@@YAIPEAXAEBIPEBX1@Z DD imagerel $LN23
	DD	imagerel $LN23+170
	DD	imagerel $unwind$?ppmd_compress@@YAIPEAXAEBIPEBX1@Z
pdata	ENDS
xdata	SEGMENT
$unwind$?ppmd_compress@@YAIPEAXAEBIPEBX1@Z DD 081401H
	DD	0e6414H
	DD	0d5414H
	DD	0c3414H
	DD	070109214H
; Function compile flags: /Ogtpy
xdata	ENDS
_TEXT	SEGMENT
dest$ = 32
source$ = 56
dest_buffer$ = 96
dest_buffer_size$ = 104
source_buffer$ = 112
source_buffer_size$ = 120
?ppmd_compress@@YAIPEAXAEBIPEBX1@Z PROC			; ppmd_compress

; 65   : {

$LN23:
	mov	QWORD PTR [rsp+8], rbx
	mov	QWORD PTR [rsp+16], rbp
	mov	QWORD PTR [rsp+24], rsi
	push	rdi
	sub	rsp, 80					; 00000050H

; 66   :     PPMd_Lock();

	mov	eax, 1
	mov	rsi, r9
	mov	rbx, r8
	xchg	DWORD PTR PPMd_Locked, eax
	mov	rbp, rdx
	mov	rdi, rcx
	test	eax, eax
	je	SHORT $LN3@ppmd_compr
	npad	1
$LL4@ppmd_compr:
	xor	ecx, ecx
	call	QWORD PTR __imp_Sleep
	mov	r11d, 1
	xchg	DWORD PTR PPMd_Locked, r11d
	test	r11d, r11d
	jne	SHORT $LL4@ppmd_compr
$LN3@ppmd_compr:

; 67   : 	ppmd_initialize	();

	call	?ppmd_initialize@@YAXXZ			; ppmd_initialize

; 68   : 
; 69   : 	stream			source(source_buffer,source_buffer_size);

	mov	r11d, DWORD PTR [rsi]

; 70   : 	stream			dest(dest_buffer,dest_buffer_size);

	mov	eax, DWORD PTR [rbp]

; 71   : 	EncodeFile		(&dest,&source,order_model,restoration_method_cut_off);

	lea	rdx, QWORD PTR source$[rsp]
	lea	rcx, QWORD PTR dest$[rsp]
	mov	DWORD PTR source$[rsp], r11d
	mov	DWORD PTR dest$[rsp], eax
	mov	QWORD PTR source$[rsp+8], rbx
	mov	QWORD PTR source$[rsp+16], rbx
	mov	QWORD PTR dest$[rsp+8], rdi
	mov	QWORD PTR dest$[rsp+16], rdi
	call	EncodeFile

; 72   : 
; 73   : 	PPMd_Unlock();
; 74   : 	return			(dest.tell());
; 75   : }

	mov	rbx, QWORD PTR [rsp+96]
	mov	rbp, QWORD PTR [rsp+104]
	mov	rsi, QWORD PTR [rsp+112]
	xor	r11d, r11d
	xchg	DWORD PTR PPMd_Locked, r11d
	mov	rax, QWORD PTR dest$[rsp+16]
	sub	rax, QWORD PTR dest$[rsp+8]
	add	rsp, 80					; 00000050H
	pop	rdi
	ret	0
?ppmd_compress@@YAIPEAXAEBIPEBX1@Z ENDP			; ppmd_compress
END
