; Listing generated by Microsoft (R) Optimizing Compiler Version 18.00.40629.0 

include listing.inc

INCLUDELIB OLDNAMES

EXTRN	__imp_strncpy:PROC
PUBLIC	?TEXT2CLSID@@YA_KPEBD@Z				; TEXT2CLSID
PUBLIC	?CLSID2TEXT@@YAX_KPEAD@Z			; CLSID2TEXT
pdata	SEGMENT
$pdata$?TEXT2CLSID@@YA_KPEBD@Z DD imagerel $LN16
	DD	imagerel $LN16+181
	DD	imagerel $unwind$?TEXT2CLSID@@YA_KPEBD@Z
xdata	SEGMENT
$unwind$?TEXT2CLSID@@YA_KPEBD@Z DD 020601H
	DD	070025206H
; Function compile flags: /Ogtpy
; File c:\users\nummer\documents\github\olr-3.0\src\xray\xrcore\clsid.cpp
_TEXT	SEGMENT
id$ = 8
text$ = 16
?CLSID2TEXT@@YAX_KPEAD@Z PROC				; CLSID2TEXT

; 5    : 	text[8]=0;

	mov	BYTE PTR [rdx+8], 0

; 6    : 	for (int i=7; i>=0; i--) { text[i]=char(id&0xff); id>>=8; }

	mov	BYTE PTR [rdx+7], cl
	shr	rcx, 8
	mov	BYTE PTR [rdx+6], cl
	shr	rcx, 8
	mov	BYTE PTR [rdx+5], cl
	shr	rcx, 8
	mov	BYTE PTR [rdx+4], cl
	shr	rcx, 8
	mov	BYTE PTR [rdx+3], cl
	shr	rcx, 8
	mov	BYTE PTR [rdx+2], cl
	shr	rcx, 8
	mov	BYTE PTR [rdx+1], cl
	shr	rcx, 8
	mov	BYTE PTR [rdx], cl

; 7    : }

	ret	0
?CLSID2TEXT@@YAX_KPEAD@Z ENDP				; CLSID2TEXT
_TEXT	ENDS
; Function compile flags: /Ogtpy
; File c:\users\nummer\documents\github\olr-3.0\src\xray\xrcore\clsid.cpp
; File c:\users\nummer\documents\github\olr-3.0\src\xray\xrcore\_std_extensions.h
; File c:\users\nummer\documents\github\olr-3.0\src\xray\xrcore\clsid.cpp
_TEXT	SEGMENT
buf$ = 32
text$ = 64
?TEXT2CLSID@@YA_KPEBD@Z PROC				; TEXT2CLSID

; 8    : XRCORE_API CLASS_ID __stdcall TEXT2CLSID(LPCSTR text) {

$LN16:
	push	rdi
	sub	rsp, 48					; 00000030H

; 11   : 	strncpy(buf,text,8);

	mov	rdx, rcx
	mov	edi, 8
	lea	rcx, QWORD PTR buf$[rsp]
	mov	r8d, edi
	mov	BYTE PTR buf$[rsp+8], 0
	call	QWORD PTR __imp_strncpy
; File c:\users\nummer\documents\github\olr-3.0\src\xray\xrcore\_std_extensions.h

; 270  : {	return (u32)strlen(S);			}

	lea	rcx, QWORD PTR buf$[rsp]
	or	rax, -1
	npad	6
$LL14@TEXT2CLSID:
	inc	rax
	cmp	BYTE PTR [rcx+rax], 0
	jne	SHORT $LL14@TEXT2CLSID
; File c:\users\nummer\documents\github\olr-3.0\src\xray\xrcore\clsid.cpp

; 12   : 	size_t need = 8-xr_strlen(buf);

	sub	edi, eax
	mov	ecx, edi

; 13   : 	while (need) { buf[8-need]=' '; need--; }

	je	SHORT $LN2@TEXT2CLSID

; 9    : 	VERIFY3(xr_strlen(text)<=8,"Beer from creator CLASS_ID:",text);
; 10   : 	char buf[9]; buf[8] = 0;

	lea	rdi, QWORD PTR buf$[rsp+8]
	mov	eax, 32					; 00000020H
	sub	rdi, rcx
	rep stosb
$LN2@TEXT2CLSID:

; 14   : 	return MK_CLSID(buf[0],buf[1],buf[2],buf[3],buf[4],buf[5],buf[6],buf[7]);

	movsx	rax, BYTE PTR buf$[rsp+1]
	movsx	rcx, BYTE PTR buf$[rsp+5]
	movsx	rdx, BYTE PTR buf$[rsp]
	shl	rdx, 8
	or	rdx, rax
	movsx	rax, BYTE PTR buf$[rsp+2]
	shl	rdx, 8
	or	rdx, rax
	movsx	rax, BYTE PTR buf$[rsp+3]
	shl	rdx, 8
	or	rdx, rax
	movsx	rax, BYTE PTR buf$[rsp+4]
	shl	rdx, 8
	or	rax, rdx
	shl	rax, 8
	or	rax, rcx
	movsx	rcx, BYTE PTR buf$[rsp+6]
	shl	rax, 8
	or	rax, rcx
	movsx	rcx, BYTE PTR buf$[rsp+7]
	shl	rax, 8
	or	rax, rcx

; 15   : }

	add	rsp, 48					; 00000030H
	pop	rdi
	ret	0
?TEXT2CLSID@@YA_KPEBD@Z ENDP				; TEXT2CLSID
_TEXT	ENDS
END
